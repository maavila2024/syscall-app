import{F as Se,E as vl,i as pl,j as We,N as fl,k as _l,l as bl}from"./vue-tabler-icons.es-d9687b9a.js";import{u as Ee,a3 as Te,B as Q,L as d,o as b,c as F,a as r,b as e,w as l,e as X,d as q,t as G,ao as De,l as ae,V as T,y as a,ap as R,m as ge,aq as Ue,I as he,F as qe,q as je,i as yl,ar as Vl,z as ve,M as Ge,N as He,p as ie,as as Qe,a8 as gl,O as Xe,P as Ye,a4 as hl,a9 as ze,at as ee,aa as Y,al as Ze,au as el,av as ll,Q as re,ab as tl,a0 as Ae,a5 as V,_ as i,ad as w,ac as K,aw as le,ax as al,S as Je,ae as Be,ay as Oe,am as ol,az as Re,a6 as xl,a7 as Ne,r as kl,ai as pe,aj as ne,ah as se,G as wl,j as Cl,aA as Fe,ag as de,af as $e,T as Sl,ak as Ul}from"./index-c970856b.js";import{u as xe}from"./tasks-17e7028d.js";import{_ as sl}from"./_plugin-vue_export-helper-c27b6911.js";import{a as y,u as Le}from"./vee-validate.esm-eb30c05b.js";const fe=A=>(Xe("data-v-72c44f76"),A=A(),Ye(),A),$l={class:"tasks-table-container"},Tl={class:"table-wrapper"},ql=q(" Chamado "),Al=q(" Sequência "),Il=q(" Título "),Ml={class:"text-left",style:{width:"175px"}},jl=q(" Solicitante "),Fl={class:"text-left",style:{width:"185px"}},Pl=q(" Responsável "),Dl={class:"text-left",style:{width:"135px"}},Ol=q(" Status "),Rl={class:"text-left",style:{width:"165px"}},Nl=q(" Prioridade "),El={class:"text-left",style:{width:"235px"}},zl=q(" Complexidade "),Jl=fe(()=>r("th",{class:"text-left",style:{width:"100px"}},"Ações",-1)),Bl=fe(()=>r("th",null,null,-1)),Ll={key:0},Gl=fe(()=>r("td",null,null,-1)),Hl=fe(()=>r("td",null,null,-1)),Ql=fe(()=>r("td",null,null,-1)),Kl={key:0},Wl={key:1},Xl={key:2},Yl={key:3},Zl={key:4},et={key:5},lt={key:6},tt={key:7},at={key:8},ot={key:9},st=fe(()=>r("td",null,null,-1)),nt=fe(()=>r("td",null,null,-1)),ut={class:"text-clamp"},it=q("Default"),dt={class:"text-clamp"},rt={class:"text-clamp"},mt={class:"text-right"},ct={class:"d-flex align-center"},vt={class:"text-clamp"},pt={class:"text-right"},ft={class:"d-flex align-center"},_t={class:"text-clamp"},bt={class:"text-right"},yt={class:"d-flex align-center"},Vt={setup(A){const I=Ee(),n=xe(),{tasks:c,toShow:W,toEdit:P,toDelete:D,taskFiles:_}=Te(n),O=Q(()=>I.user.teams.some(k=>k.is_admin)),h=d([]),S=d([]),U=d([]),z=d([]),M=d([]),C=d(!1),N=d(!1),J=d(!1),B=d(!1),L=d(!1),$=Q(()=>[...new Set(c.value.map(k=>k.task_status.name))]),g=Q(()=>[...new Set(c.value.map(k=>k.user_owner.first_name))]),j=Q(()=>[...new Set(c.value.map(k=>{var p;return((p=k.user_responsible)==null?void 0:p.first_name)||"Nenhum responsável"}))]),x=Q(()=>[...new Set(c.value.map(k=>k.priority.name))]),E=Q(()=>[...new Set(c.value.map(k=>k.complexity.name))]),v=d(!1),u=d(!1),t=d(!1),o=d(!1),te=d(!1),ke=()=>{v.value=h.value.length===$.value.length},_e=()=>{u.value=S.value.length===g.value.length},be=()=>{t.value=U.value.length===j.value.length},we=()=>{o.value=z.value.length===x.value.length},ye=()=>{te.value=M.value.length===E.value.length},Ie=()=>{v.value?h.value=[]:h.value=[...$.value]},H=()=>{u.value?S.value=[]:S.value=[...g.value]},m=()=>{t.value?U.value=[]:U.value=[...j.value]},f=()=>{o.value?z.value=[]:z.value=[...x.value]},dl=()=>{te.value?M.value=[]:M.value=[...E.value]},me=d(""),ue=d("asc"),Pe=k=>{me.value===k?ue.value=ue.value==="asc"?"desc":"asc":(me.value=k,ue.value="asc")},rl=Q(()=>{const k=[...c.value];return k.sort((p,s)=>{const Ve=p[me.value],ce=s[me.value];return Ve<ce?ue.value==="asc"?-1:1:Ve>ce?ue.value==="asc"?1:-1:0}),k}),ml=Q(()=>c.value?rl.value.filter(k=>{var Ce;if(!k)return!1;const p=h.value.length===0||h.value.includes(k.task_status.name),s=S.value.length===0||S.value.includes(k.user_owner.first_name),Ve=U.value.length===0||U.value.includes(((Ce=k.user_responsible)==null?void 0:Ce.first_name)||"Nenhum responsável"),ce=z.value.length===0||z.value.includes(k.priority.name),Me=M.value.length===0||M.value.includes(k.complexity.name);return p&&s&&Ve&&ce&&Me}):[]),cl=k=>({color:k.color});return(k,p)=>(b(),F("div",$l,[r("div",Tl,[e(gl,{class:"border-opacity-100"},{default:l(()=>[r("thead",null,[r("tr",null,[r("th",{class:"text-left",style:{width:"50px"},onClick:p[0]||(p[0]=s=>Pe("task_code"))},[ql,me.value==="task_code"?(b(),X(De,{key:0},{default:l(()=>[q(G(ue.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):ae("",!0)]),r("th",{class:"text-left",style:{width:"50px"},onClick:p[1]||(p[1]=s=>Pe("sequence"))},[Al,me.value==="sequence"?(b(),X(De,{key:0},{default:l(()=>[q(G(ue.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):ae("",!0)]),r("th",{class:"text-left",style:{width:"50px"},onClick:p[2]||(p[2]=s=>Pe("name"))},[Il,me.value==="name"?(b(),X(De,{key:0},{default:l(()=>[q(G(ue.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):ae("",!0)]),r("th",Ml,[jl,e(T,{icon:"",onClick:p[3]||(p[3]=s=>N.value=!N.value)},{default:l(()=>[e(a(Se))]),_:1})]),r("th",Fl,[Pl,e(T,{icon:"",onClick:p[4]||(p[4]=s=>J.value=!J.value)},{default:l(()=>[e(a(Se))]),_:1})]),r("th",Dl,[Ol,e(T,{icon:"",onClick:p[5]||(p[5]=s=>C.value=!C.value)},{default:l(()=>[e(a(Se))]),_:1})]),r("th",Rl,[Nl,e(T,{icon:"",onClick:p[6]||(p[6]=s=>B.value=!B.value)},{default:l(()=>[e(a(Se))]),_:1})]),r("th",El,[zl,e(T,{icon:"",onClick:p[7]||(p[7]=s=>L.value=!L.value)},{default:l(()=>[e(a(Se))]),_:1})]),Jl,Bl])]),r("tbody",null,[N.value||J.value||C.value||B.value||L.value?(b(),F("tr",Ll,[Gl,Hl,Ql,N.value?(b(),F("td",Kl,[e(R,{modelValue:S.value,"onUpdate:modelValue":p[9]||(p[9]=s=>S.value=s),items:a(g),label:"Filtro Solicitante",multiple:"",onChange:_e},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e(Ue,{modelValue:u.value,"onUpdate:modelValue":p[8]||(p[8]=s=>u.value=s),label:u.value?"Desmarcar todos":"Selecionar todos",onChange:H},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(b(),F("td",Wl)),J.value?(b(),F("td",Xl,[e(R,{modelValue:U.value,"onUpdate:modelValue":p[11]||(p[11]=s=>U.value=s),items:a(j),label:"Filtro Responsável",multiple:"",onChange:be},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e(Ue,{modelValue:t.value,"onUpdate:modelValue":p[10]||(p[10]=s=>t.value=s),label:t.value?"Desmarcar todos":"Selecionar todos",onChange:m},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(b(),F("td",Yl)),C.value?(b(),F("td",Zl,[e(R,{modelValue:h.value,"onUpdate:modelValue":p[13]||(p[13]=s=>h.value=s),items:a($),label:"Filtro Status",multiple:"",onChange:ke},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e(Ue,{modelValue:v.value,"onUpdate:modelValue":p[12]||(p[12]=s=>v.value=s),label:v.value?"Desmarcar todos":"Selecionar todos",onChange:Ie},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(b(),F("td",et)),B.value?(b(),F("td",lt,[e(R,{modelValue:z.value,"onUpdate:modelValue":p[15]||(p[15]=s=>z.value=s),items:a(x),label:"Filtro Prioridade",multiple:"",onChange:we},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e(Ue,{modelValue:o.value,"onUpdate:modelValue":p[14]||(p[14]=s=>o.value=s),label:o.value?"Desmarcar todos":"Selecionar todos",onChange:f},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(b(),F("td",tt)),L.value?(b(),F("td",at,[e(R,{modelValue:M.value,"onUpdate:modelValue":p[17]||(p[17]=s=>M.value=s),items:a(E),label:"Filtro Complexidade",multiple:"",onChange:ye},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e(Ue,{modelValue:te.value,"onUpdate:modelValue":p[16]||(p[16]=s=>te.value=s),label:te.value?"Desmarcar todos":"Selecionar todos",onChange:dl},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(b(),F("td",ot)),st,nt])):ae("",!0),(b(!0),F(qe,null,je(a(ml),(s,Ve)=>{var ce,Me,Ce;return b(),F("tr",{key:(s==null?void 0:s.id)||Ve},[r("td",null,G(s==null?void 0:s.task_code),1),r("td",null,G(s==null?void 0:s.sequence),1),r("td",null,[r("div",ut,G(s==null?void 0:s.name),1),s!=null&&s.default?(b(),X(yl,{key:0,size:"small",variant:"tonal",color:"primary",class:"ml-2"},{default:l(()=>[it]),_:1})):ae("",!0)]),r("td",null,[r("div",dt,G((ce=s==null?void 0:s.user_owner)==null?void 0:ce.first_name),1)]),r("td",null,[r("div",rt,G(((Me=s==null?void 0:s.user_responsible)==null?void 0:Me.first_name)||"Nenhum responsável"),1)]),r("td",null,[r("div",{class:"text-clamp",style:Vl(cl(s==null?void 0:s.task_status))},G((Ce=s==null?void 0:s.task_status)==null?void 0:Ce.name),5)]),r("td",mt,[r("div",ct,[e(ve,{text:s==null?void 0:s.priority_justification},{activator:l(({props:Z})=>[e(T,Ge(He(Z)),{default:l(()=>{var oe;return[r("span",ie(k.attrs,Qe(k.on)),[r("div",vt,G((oe=s==null?void 0:s.priority)==null?void 0:oe.name),1)],16)]}),_:2},1040)]),_:2},1032,["text"])])]),r("td",pt,[r("div",ft,[e(ve,{text:(s==null?void 0:s.complexity_justification)||"Aguardando análise"},{activator:l(({props:Z})=>[e(T,Ge(He(Z)),{default:l(()=>{var oe;return[r("span",ie(k.attrs,Qe(k.on)),[r("div",_t,G(((oe=s==null?void 0:s.complexity)==null?void 0:oe.name)||"Aguardando análise"),1)],16)]}),_:2},1040)]),_:2},1032,["text"])])]),r("td",bt,[r("div",yt,[e(ve,{text:"Visualizar Chamado"},{activator:l(({props:Z})=>[e(T,ie({icon:"",flat:"",onClick:oe=>W.value=s},Z),{default:l(()=>[e(a(vl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),a(O)?(b(),X(ve,{key:0,text:"Editar Chamado"},{activator:l(({props:Z})=>[e(T,ie({icon:"",flat:"",onClick:oe=>P.value=s},Z),{default:l(()=>[e(a(pl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024)):ae("",!0),a(O)?(b(),X(ve,{key:1,text:"Deletar Chamado"},{activator:l(({props:Z})=>[e(T,ie({icon:"",flat:"",onClick:oe=>D.value=s},Z),{default:l(()=>[e(a(We),{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1024)):ae("",!0),e(ve,{text:"Consultar Notas de Trabalho"},{activator:l(({props:Z})=>[e(T,ie({icon:"",flat:"",onClick:oe=>k.$emit("openChat",s)},Z),{default:l(()=>[e(a(fl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),e(ve,{text:"Anexos"},{activator:l(({props:Z})=>[e(T,ie({icon:"",flat:"",onClick:oe=>k.$emit("openAttachments",s)},Z),{default:l(()=>[e(a(_l),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024)])])])}),128))])]),_:1})])]))}},gt=sl(Vt,[["__scopeId","data-v-72c44f76"]]),ht={emits:["cancel","add"],setup(A,{emit:I}){const n=Ee(),c=xe();d([]);const W=[{label:"Grãos",value:1},{label:"Proteína",value:2}],P=[{label:"Algo que funcionava, parou de funcionar?",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)?",value:2}],D=Q(()=>{var u;return((u=c.priori.find(t=>t.is_default))==null?void 0:u.id)||null}),_=Q(()=>{var u;return((u=c.taskStatus.find(t=>t.is_default))==null?void 0:u.id)||null}),{value:O}=y("segment",2),{value:h}=y("priority_id"),{value:S}=y("task_status_id");hl(()=>{D.value&&!h.value&&(h.value=D.value),_.value&&!S.value&&(S.value=_.value)});const U=Q(()=>{const u=c.priori.find(t=>t.id===h.value);return u&&u.justify}),z=Q(()=>ze({segment:ee().required().label("Segmento"),task_type:ee().required().label("Tipo de chamado"),name:Y().required().label("Título"),system_screen:Y().required().label("Tela"),description:Y().required().label("Descrição"),owner_id:ee().required().label("Solicitante"),task_status_id:ee().required().label("Status do Chamado"),priority_id:ee().required().label("Prioridade"),observation:Y().nullable().label("Observação"),priority_justification:U.value?Y().required().label("Justificativa da Prioridade"):Y().label("Justificativa da Prioridade"),status:Ze().required().label("Status"),files:el().of(ll()).nullable()})),{handleSubmit:M,errors:C,isSubmitting:N}=Le({validationSchema:z,initialValues:{segment:1,task_type:"",name:"",system_screen:"",description:"",owner_id:n.user.id,responsible_id:"",task_status_id:_.value,priority_id:D.value,observation:"",created_at:"",expected_date:"",finish_date:"",priority_justification:"",status:!0,files:[]}}),J=M(async u=>{console.log("priority_id at submit:",h.value),console.log("values before sending:",u),u.priority_id=h.value;try{const t=v.value,o=await c.storeTask(u,t);I("add")}catch(t){console.error("Erro ao adicionar comentário ou fazer upload dos arquivos:",t)}}),B=d(""),{value:L}=y("name"),{value:$}=y("task_type"),{value:g}=y("system_screen"),{value:j}=y("description");y("owner_id"),y("responsible_id");const{value:x}=y("observation");y("created_at"),y("expected_date"),y("finish_date");const{value:E}=y("priority_justification");y("status");const{value:v}=y("files");return re(D,u=>{u&&!h.value&&(h.value=u)}),re(_,u=>{u&&!S.value&&(S.value=u)}),re(h,u=>{console.log("priority_id changed to:",u),U.value||(E.value="")}),(u,t)=>(b(),F("div",null,[B.value?(b(),X(tl,{key:0,color:"error",class:"mb-2"},{default:l(()=>[q(G(B.value),1)]),_:1})):ae("",!0),e(Be,{onSubmit:Je(a(J),["prevent"])},{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(O),"onUpdate:modelValue":t[0]||(t[0]=o=>w(O)?O.value=o:null),"error-messages":a(C).segment,items:W,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a($),"onUpdate:modelValue":t[1]||(t[1]=o=>w($)?$.value=o:null),"error-messages":a(C).task_type,items:P,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(K,{modelValue:a(L),"onUpdate:modelValue":t[2]||(t[2]=o=>w(L)?L.value=o:null),"error-messages":a(C).name,label:"Título",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(K,{modelValue:a(g),"onUpdate:modelValue":t[3]||(t[3]=o=>w(g)?g.value=o:null),"error-messages":a(C).system_screen,label:"Tela",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(le,{modelValue:a(j),"onUpdate:modelValue":t[4]||(t[4]=o=>w(j)?j.value=o:null),"error-messages":a(C).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(le,{modelValue:a(x),"onUpdate:modelValue":t[5]||(t[5]=o=>w(x)?x.value=o:null),"error-messages":a(C).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12",md:"12"},{default:l(()=>[e(R,{modelValue:a(h),"onUpdate:modelValue":t[6]||(t[6]=o=>w(h)?h.value=o:null),"error-messages":a(C).priority_id,items:a(c).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),a(U)?(b(),X(V,{key:0},{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(le,{modelValue:a(E),"onUpdate:modelValue":t[7]||(t[7]=o=>w(E)?E.value=o:null),"error-messages":a(C).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})):ae("",!0),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(al,{modelValue:a(v),"onUpdate:modelValue":t[8]||(t[8]=o=>w(v)?v.value=o:null),label:"Anexos do chamado",multiple:"","error-messages":a(C).files,"show-size":""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,{justify:"end"},{default:l(()=>[e(i,{cols:"12",md:"auto"},{default:l(()=>[e(T,{flat:"",text:"Cancelar",onClick:t[9]||(t[9]=o=>I("cancel"))})]),_:1}),e(i,{cols:"12",md:"auto"},{default:l(()=>[e(T,{type:"submit",color:"primary",flat:"",loading:a(N),text:"Adicionar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},xt={props:{task:{type:Object,required:!0}},emits:["cancel","edit"],setup(A,{emit:I}){const n=A,c=xe(),W=[{label:"Grãos",value:1},{label:"Proteína",value:2}],P=[{label:"Algo que funcionava, parou de funcionar?",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)?",value:2}],{handleSubmit:D,errors:_,isSubmitting:O,setFieldValue:h,setErrors:S}=Le({validationSchema:ze({segment:ee().required().label("Segmento"),task_type:ee().required().label("Tipo de chamado"),task_code:Y().required().label("Número do chamado"),name:Y().required().label("Título"),system_screen:Y().required().label("Tela"),sequence:ee().nullable().label("Sequência"),description:Y().required().label("Descrição"),owner_id:ee().required().label("Solicitante"),responsible_id:ee().required().label("Responsável"),task_status_id:ee().required().label("Status do Chamado"),priority_id:ee().required().label("Prioridade do Chamado"),complexity_id:ee().required().label("Complexidade do Chamado"),observation:Y().nullable().label("Observação"),created_at:Oe().nullable().label("Data de Criação"),expected_date:Oe().nullable().label("Data de Criação").transform((H,m)=>m===""?null:H),finish_date:Oe().nullable().label("Data de Conclusão").transform((H,m)=>m===""?null:H),priority_justification:Y().nullable().label("Justificativa da Prioridade"),complexity_justification:Y().nullable().label("Justificativa da Complexidade"),status:Ze().required().label("Status")}),initialValues:{segment:n.task.segment,task_type:n.task.task_type,task_code:n.task.task_code,name:n.task.name,description:n.task.description,owner_id:n.task.owner_id,responsible_id:n.task.responsible_id,task_status_id:n.task.task_status_id,system_screen:n.task.system_screen,sequence:n.task.sequence,observation:n.task.observation,priority_id:n.task.priority_id,complexity_id:n.task.complexity_id,priority_justification:n.task.priority_justification,complexity_justification:n.task.complexity_justification,finish_date:n.task.finish_date?n.task.finish_date.split("T")[0]:null,expected_date:n.task.expected_date?n.task.expected_date.split("T")[0]:null,created_at:n.task.created_at?n.task.created_at.split("T")[0]:null,status:n.task.status}}),U={complexityRef:d(null),complexityJustificationRef:d(null),responsibleRef:d(null)},z=()=>{_.responsible_id?Re(()=>{U.responsibleRef.value.focus(),U.responsibleRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})}):_.complexity_id?Re(()=>{U.complexityRef.value.focus(),U.complexityRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})}):_.complexity_justification&&Re(()=>{U.complexityJustificationRef.value.focus(),U.complexityJustificationRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})})};re(_,H=>{console.log(_),z()});const M=D(async H=>{Ie.value||delete H.priority_justification,_e.value||(H.expected_date=null),be.value||(H.finish_date=null),console.log("Payload being sent to the backend:",H),await c.updateTask(n.task.id,H),I("edit")}),C=d(""),{value:N}=y("segment"),{value:J}=y("priority_id"),{value:B}=y("complexity_id"),{value:L}=y("name"),{value:$}=y("task_code"),{value:g}=y("task_type"),{value:j}=y("description"),{value:x}=y("owner_id"),{value:E}=y("responsible_id"),{value:v}=y("task_status_id"),{value:u}=y("system_screen"),{value:t}=y("sequence"),{value:o}=y("observation"),{value:te}=y("priority_justification"),{value:ke}=y("complexity_justification"),{value:_e}=y("expected_date"),{value:be}=y("finish_date"),{value:we}=y("created_at"),{value:ye}=y("status"),Ie=Q(()=>{const H=c.priori.find(m=>m.id===J.value);return H&&H.justify});return re(J,H=>{Ie.value?h("priority_justification",te.value||""):(te.value="",S({priority_justification:void 0}))}),(H,m)=>(b(),F("div",null,[C.value?(b(),X(tl,{key:0,color:"error",class:"mb-2"},{default:l(()=>[q(G(C.value),1)]),_:1})):ae("",!0),e(Be,{onSubmit:Je(a(M),["prevent"])},{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(N),"onUpdate:modelValue":m[0]||(m[0]=f=>w(N)?N.value=f:null),"error-messages":a(_).segment,items:W,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(g),"onUpdate:modelValue":m[1]||(m[1]=f=>w(g)?g.value=f:null),"error-messages":a(_).task_type,items:P,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a($),"onUpdate:modelValue":m[2]||(m[2]=f=>w($)?$.value=f:null),"error-messages":a(_).task_code,label:"Número do chamado",variant:"outlined",color:"primary",disabled:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(L),"onUpdate:modelValue":m[3]||(m[3]=f=>w(L)?L.value=f:null),"error-messages":a(_).name,label:"Título",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(u),"onUpdate:modelValue":m[4]||(m[4]=f=>w(u)?u.value=f:null),"error-messages":a(_).system_screen,label:"Tela",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(t),"onUpdate:modelValue":m[5]||(m[5]=f=>w(t)?t.value=f:null),"error-messages":a(_).sequence,label:"Sequência",variant:"outlined",color:"primary",maxlength:"10",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(le,{modelValue:a(j),"onUpdate:modelValue":m[6]||(m[6]=f=>w(j)?j.value=f:null),"error-messages":a(_).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(x),"onUpdate:modelValue":m[7]||(m[7]=f=>w(x)?x.value=f:null),"error-messages":a(_).owner_id,items:a(c).users,label:"Solicitante","item-title":"first_name","item-value":"id",disabled:""},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(we),"onUpdate:modelValue":m[8]||(m[8]=f=>w(we)?we.value=f:null),"error-messages":a(_).created_at,label:"Data de Criação",variant:"outlined",type:"date",disabled:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(v),"onUpdate:modelValue":m[9]||(m[9]=f=>w(v)?v.value=f:null),"error-messages":a(_).task_status_id,items:a(c).taskStatus,label:"Status do Chamado","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(E),"onUpdate:modelValue":m[10]||(m[10]=f=>w(E)?E.value=f:null),"error-messages":a(_).responsible_id,items:a(c).users,label:"Responsável","item-title":"first_name","item-value":"id",ref:"responsibleRef"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(le,{modelValue:a(o),"onUpdate:modelValue":m[11]||(m[11]=f=>w(o)?o.value=f:null),"error-messages":a(_).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(_e),"onUpdate:modelValue":m[12]||(m[12]=f=>w(_e)?_e.value=f:null),"error-messages":a(_).expected_date,label:"Data Esperada",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(be),"onUpdate:modelValue":m[13]||(m[13]=f=>w(be)?be.value=f:null),"error-messages":a(_).finish_date,label:"Data de Conclusão",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(J),"onUpdate:modelValue":m[14]||(m[14]=f=>w(J)?J.value=f:null),"error-messages":a(_).priority_id,items:a(c).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(le,{modelValue:a(te),"onUpdate:modelValue":m[15]||(m[15]=f=>w(te)?te.value=f:null),"error-messages":a(_).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(B),"onUpdate:modelValue":m[16]||(m[16]=f=>w(B)?B.value=f:null),"error-messages":a(_).complexity_id,items:a(c).complexity,label:"Complexidade do Chamado","item-title":"name","item-value":"id",ref:"complexityRef"},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(le,{modelValue:a(ke),"onUpdate:modelValue":m[17]||(m[17]=f=>w(ke)?ke.value=f:null),"error-messages":a(_).complexity_justification,label:"Justificativa da Complexidade",variant:"outlined",color:"primary",rows:"5",ref:"complexityJustificationRef",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(ol,{modelValue:a(ye),"onUpdate:modelValue":m[18]||(m[18]=f=>w(ye)?ye.value=f:null),label:a(ye)?"Ativo":"Inativo",color:"primary",inset:""},null,8,["modelValue","label"])]),_:1})]),_:1}),e(V,{justify:"end"},{default:l(()=>[e(i,{cols:"12",md:"auto"},{default:l(()=>[e(T,{flat:"",text:"Cancelar",onClick:m[19]||(m[19]=f=>I("cancel"))})]),_:1}),e(i,{cols:"12",md:"auto"},{default:l(()=>[e(T,{type:"submit",color:"primary",flat:"",loading:a(O),text:"Editar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},kt={props:{task:{type:Object,required:!0}},emits:["cancel"],setup(A,{emit:I}){const n=A,c=xe(),W=[{label:"Grãos",value:1},{label:"Proteína",value:2}],P=[{label:"Algo que funcionava, parou de funcionar!",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)!",value:2}],D=d(n.task.segment),_=d(n.task.task_type),O=d(n.task.task_code),h=d(n.task.name),S=d(n.task.description),U=d(n.task.owner_id),z=d(n.task.responsible_id),M=d(n.task.task_status_id),C=d(n.task.system_screen),N=d(n.task.sequence),J=d(n.task.observation),B=d(n.task.priority_id),L=d(n.task.complexity_id),$=d(n.task.priority_justification),g=d(n.task.complexity_justification),j=d(n.task.finish_date?n.task.finish_date.split("T")[0]:null),x=d(n.task.expected_date?n.task.expected_date.split("T")[0]:null),E=d(n.task.created_at?n.task.created_at.split("T")[0]:null),v=d(n.task.status);return(u,t)=>(b(),F("div",null,[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:D.value,"onUpdate:modelValue":t[0]||(t[0]=o=>D.value=o),items:W,label:"Segmento","item-title":"label","item-value":"value",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=o=>_.value=o),items:P,label:"Tipo de chamado","item-title":"label","item-value":"value",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:O.value,"onUpdate:modelValue":t[2]||(t[2]=o=>O.value=o),label:"Número do chamado",variant:"outlined",color:"primary",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=o=>h.value=o),label:"Título",variant:"outlined",color:"primary",readonly:"",class:"custom-label",rows:"2",maxlength:"60"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:C.value,"onUpdate:modelValue":t[4]||(t[4]=o=>C.value=o),label:"Tela",variant:"outlined",color:"primary",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:N.value,"onUpdate:modelValue":t[5]||(t[5]=o=>N.value=o),label:"Sequência",variant:"outlined",color:"primary",maxlength:"10",counter:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(le,{modelValue:S.value,"onUpdate:modelValue":t[6]||(t[6]=o=>S.value=o),label:"Descrição",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"150",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:U.value,"onUpdate:modelValue":t[7]||(t[7]=o=>U.value=o),items:a(c).users,label:"Solicitante","item-title":"first_name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:E.value,"onUpdate:modelValue":t[8]||(t[8]=o=>E.value=o),label:"Data de Criação",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:M.value,"onUpdate:modelValue":t[9]||(t[9]=o=>M.value=o),items:a(c).taskStatus,label:"Status do Chamado","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:z.value,"onUpdate:modelValue":t[10]||(t[10]=o=>z.value=o),items:a(c).users,label:"Responsável","item-title":"first_name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(le,{modelValue:J.value,"onUpdate:modelValue":t[11]||(t[11]=o=>J.value=o),label:"Observação",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:x.value,"onUpdate:modelValue":t[12]||(t[12]=o=>x.value=o),label:"Data Esperada",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:j.value,"onUpdate:modelValue":t[13]||(t[13]=o=>j.value=o),label:"Data de Conclusão",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:B.value,"onUpdate:modelValue":t[14]||(t[14]=o=>B.value=o),items:a(c).priori,label:"Prioridade","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(le,{modelValue:$.value,"onUpdate:modelValue":t[15]||(t[15]=o=>$.value=o),label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:L.value,"onUpdate:modelValue":t[16]||(t[16]=o=>L.value=o),items:a(c).complexity,label:"Complexidade do Chamado","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(le,{modelValue:g.value,"onUpdate:modelValue":t[17]||(t[17]=o=>g.value=o),label:"Justificativa da Complexidade",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(ol,{modelValue:v.value,"onUpdate:modelValue":t[18]||(t[18]=o=>v.value=o),label:v.value?"Ativo":"Inativo",color:"primary",inset:"",disabled:""},null,8,["modelValue","label"])]),_:1})]),_:1}),e(V,{justify:"end"},{default:l(()=>[e(i,{cols:"12",md:"auto"},{default:l(()=>[e(T,{flat:"",text:"Fechar",onClick:t[19]||(t[19]=o=>u.$emit("cancel"))})]),_:1})]),_:1})]),_:1})]))}},nl=xl("chats",{state:()=>({messages:[]}),actions:{async fetchMessages(A){try{const I=await Ne.get(`/api/interactions/${A}`);this.messages=I.data}catch(I){console.error("Error fetching messages:",I)}},async createInteraction(A,I,n){try{return(await Ne.post("/api/interactions",{task_id:A,comment:I,user_id:n})).data}catch(c){console.error("Error creating interaction:",c)}},async uploadFile(A){try{return(await Ne.post("/api/interaction-file",A,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(I){throw console.error("Error uploading file:",I),I}}}});function ul(A){return`https://syscall-api.devtest.com.br//storage/${A}`}const il=A=>(Xe("data-v-4ff77f2d"),A=A(),Ye(),A),wt=il(()=>r("span",{class:"text-h5"},"Notas de Trabalho",-1)),Ct={class:"comment-text"},St={key:0},Ut=["href"],$t={class:"text-right text-caption mt-2"},Tt={class:"email-text"},qt=q(" - "),At={class:"email-text"},It=q("Adicionar Comentário"),Mt=q("Fechar"),jt=il(()=>r("span",{class:"text-h5"},"Adicionar Comentário",-1)),Ft=q("Cancelar"),Pt=q("Adicionar"),Dt={props:{taskId:{type:Number,required:!0},showChatModal:{type:Boolean,required:!0},userId:{type:Number,required:!0}},emits:["update:showChatModal"],setup(A,{emit:I}){const n=A,c=nl(),{messages:W}=Te(c),P=d(!1),D=d(!1),_=ze({comment:Y().required().label("Comentário"),files:el().of(ll()).nullable()}),{handleSubmit:O,errors:h,isSubmitting:S,resetForm:U}=Le({validationSchema:_,initialValues:{comment:"",files:[]}}),z=O(async $=>{try{const g=await c.createInteraction(n.taskId,$.comment,n.userId);if($.files&&$.files.length>0){const j=new FormData;j.append("interaction_id",g.id);for(const x of $.files)j.append("files[]",x);await c.uploadFile(j)}await c.fetchMessages(n.taskId),D.value=!1,I("update:showChatModal",!1)}catch(g){console.error("Erro ao adicionar comentário ou fazer upload dos arquivos:",g)}}),{value:M}=y("comment"),{value:C}=y("files");re(()=>n.showChatModal,async $=>{$?(P.value=!0,await c.fetchMessages(n.taskId)):P.value=!1});const N=()=>{I("update:showChatModal",!1)},J=()=>{U(),D.value=!0},B=$=>{const g={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return new Date($).toLocaleDateString("pt-BR",g)},L=Q(()=>[...W.value].sort(($,g)=>g.id-$.id));return($,g)=>{const j=kl("v-list-item-content");return b(),X(de,{modelValue:P.value,"onUpdate:modelValue":g[4]||(g[4]=x=>P.value=x),"max-width":"800px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[wt]),_:1}),e(ne,null,{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[(b(!0),F(qe,null,je(a(L),(x,E)=>(b(),X(i,{key:E,cols:"12"},{default:l(()=>[e(se,{class:"mb-3"},{default:l(()=>[e(ne,null,{default:l(()=>[r("div",Ct,G(x.comment),1),x.interaction_files&&x.interaction_files.length?(b(),F("div",St,[e(he),e(wl,null,{default:l(()=>[(b(!0),F(qe,null,je(x.interaction_files,(v,u)=>(b(),X(ge,{key:u},{default:l(()=>[e(j,null,{default:l(()=>[e(Cl,null,{default:l(()=>[r("a",{href:a(ul)(v.path),target:"_blank"},G(v.name),9,Ut)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])):ae("",!0),r("div",$t,[r("span",Tt,G(x.user_email),1),qt,r("span",At,G(B(x.created_at)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(Fe,null,{default:l(()=>[e(T,{color:"primary",onClick:J},{default:l(()=>[It]),_:1}),e(T,{color:"secondary",onClick:N},{default:l(()=>[Mt]),_:1})]),_:1})]),_:1}),e(de,{modelValue:D.value,"onUpdate:modelValue":g[3]||(g[3]=x=>D.value=x),"max-width":"500px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[jt]),_:1}),e(ne,null,{default:l(()=>[e(Be,{onSubmit:Je(a(z),["prevent"])},{default:l(()=>[e(le,{modelValue:a(M),"onUpdate:modelValue":g[0]||(g[0]=x=>w(M)?M.value=x:null),label:"Comentário","error-messages":a(h).comment},null,8,["modelValue","error-messages"]),e(al,{modelValue:a(C),"onUpdate:modelValue":g[1]||(g[1]=x=>w(C)?C.value=x:null),label:"Selecionar Arquivos","error-messages":a(h).files,"show-size":"",multiple:""},null,8,["modelValue","error-messages"])]),_:1},8,["onSubmit"])]),_:1}),e(Fe,null,{default:l(()=>[e(T,{color:"blue darken-1",text:"",onClick:g[2]||(g[2]=x=>D.value=!1)},{default:l(()=>[Ft]),_:1}),e(T,{color:"blue darken-1",text:"",loading:a(S),onClick:a(z)},{default:l(()=>[Pt]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},Ke=sl(Dt,[["__scopeId","data-v-4ff77f2d"]]),Ot=r("span",{class:"text-h5"},"Anexos do Chamado",-1),Rt=["href"],Nt=q("Fechar"),Et={props:{taskId:{type:Number,required:!0},showAttachmentsModal:{type:Boolean,required:!0}},emits:["update:showAttachmentsModal"],setup(A,{emit:I}){const n=A,c=xe(),{taskFiles:W}=Te(c),P=d(!1);re(()=>n.showAttachmentsModal,async O=>{O?(await c.getTaskFiles(n.taskId),P.value=!0):P.value=!1});const D=()=>{I("update:showAttachmentsModal",!1)},_=async O=>{await c.deleteTaskFile(O),await c.getTaskFiles(n.taskId)};return(O,h)=>(b(),X(de,{modelValue:P.value,"onUpdate:modelValue":h[0]||(h[0]=S=>P.value=S),"max-width":"800px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[Ot]),_:1}),e(ne,null,{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[(b(!0),F(qe,null,je(a(W),(S,U)=>(b(),X(i,{key:U,cols:"12"},{default:l(()=>[e(se,{class:"mb-3"},{default:l(()=>[e(ne,null,{default:l(()=>[r("a",{href:a(ul)(S.path),target:"_blank"},G(S.name),9,Rt),e(T,{icon:"",onClick:z=>_(S.id)},{default:l(()=>[e(a(bl))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(Fe,null,{default:l(()=>[e(T,{color:"secondary",onClick:D},{default:l(()=>[Nt]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},zt={class:"mb-5 pb-5 border-b border-opacity-100"},Jt=q("Novo Chamado"),Bt=q("Adicionar chamado"),Lt=q("Visualizar chamado"),Gt=q("Editar chamado"),Ht=q("Cancelar"),Qt=q("Deletar"),Kt=r("span",{class:"text-h5"},"Adicionar Nota de Trabalho",-1),Wt=q("Cancelar"),Xt=q("Adicionar"),aa={setup(A){const I=Ee(),n=xe(),{toShow:c,toEdit:W,toDelete:P}=Te(n),D=nl();Te(D);const{isLoading:_}=$e(n.getTasks());$e(n.getPriorities()),$e(n.getComplexities()),$e(n.getTasksStatus()),$e(n.getUsers());const O=Q({get(){return!!Object.keys(W.value).length},set(v){v||(W.value={})}}),h=Q({get(){return!!Object.keys(c.value).length},set(v){v||(c.value={})}}),S=Q({get(){return!!Object.keys(P.value).length},set(v){v||(P.value={})}}),U=d(!1);async function z(v){U.value=!0,await n.deleteTask(v.id),P.value={},U.value=!1}const M=d(!1),C=d(0),N=d(!1),J=d(""),B=d(I.user.id),L=v=>{v&&v.id&&(C.value=v.id,M.value=!0)},$=v=>{v&&v.id&&(C.value=v.id,N.value=!0)},g=async()=>{await D.addMessage(C.value,J.value,B.value),J.value="",N.value=!1},j=d(!1),x=v=>{v&&v.id&&(C.value=v.id,j.value=!0)},E=d("");return re(E,v=>{n.getTasks(v)}),(v,u)=>(b(),F("div",null,[r("div",zt,[e(V,null,{default:l(()=>[e(i,{cols:"12",lg:"4",md:"6"},{default:l(()=>[e(K,{density:"compact",modelValue:E.value,"onUpdate:modelValue":u[0]||(u[0]=t=>E.value=t),label:"Pesquisar Chamados","append-inner-icon":"mdi-magnify","hide-details":"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(i,{class:"text-right"},{default:l(()=>[e(de,{width:"800",persistent:""},{activator:l(({props:t})=>[e(T,ie({flat:"",color:"primary"},t),{default:l(()=>[Jt]),_:2},1040)]),default:l(({isActive:t})=>[e(se,{width:"800"},{default:l(()=>[e(pe,null,{default:l(()=>[Bt]),_:1}),e(ne,null,{default:l(()=>[e(ht,{onAdd:o=>t.value=!1,onCancel:o=>t.value=!1},null,8,["onAdd","onCancel"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1})]),_:1})]),a(_)?(b(),X(Ul,{key:0,width:3,color:"primary",indeterminate:""})):(b(),F(qe,{key:1},[e(gt,{onOpenChat:L,onAddNote:$,onOpenAttachments:x}),e(de,{modelValue:a(h),"onUpdate:modelValue":u[1]||(u[1]=t=>w(h)?h.value=t:null),width:"800",persistent:""},{default:l(({isActive:t})=>[e(se,{width:"800"},{default:l(()=>[e(pe,null,{default:l(()=>[Lt]),_:1}),e(ne,null,{default:l(()=>[e(kt,{task:a(c),onCancel:o=>t.value=!1,onShow:o=>t.value=!1},null,8,["task","onCancel","onShow"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(de,{modelValue:a(O),"onUpdate:modelValue":u[2]||(u[2]=t=>w(O)?O.value=t:null),width:"800",persistent:""},{default:l(({isActive:t})=>[e(se,{width:"800"},{default:l(()=>[e(pe,null,{default:l(()=>[Gt]),_:1}),e(ne,null,{default:l(()=>[e(xt,{task:a(W),onCancel:o=>t.value=!1,onEdit:o=>t.value=!1},null,8,["task","onCancel","onEdit"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(de,{modelValue:a(S),"onUpdate:modelValue":u[4]||(u[4]=t=>w(S)?S.value=t:null),width:"800",persistent:""},{default:l(({isActive:t})=>[e(se,{"prepend-icon":a(We),title:"Você tem certeza que deseja deletar este chamado?"},{actions:l(()=>[e(Sl),e(T,{onClick:o=>t.value=!1},{default:l(()=>[Ht]),_:2},1032,["onClick"]),e(T,{onClick:u[3]||(u[3]=o=>z(a(P))),variant:"tonal",color:"error",loading:U.value},{default:l(()=>[Qt]),_:1},8,["loading"])]),_:2},1032,["prepend-icon"])]),_:1},8,["modelValue"])],64)),e(Ke,{taskId:C.value,showChatModal:M.value,userId:B.value,"onUpdate:showChatModal":u[5]||(u[5]=t=>M.value=t)},null,8,["taskId","showChatModal","userId"]),e(de,{modelValue:N.value,"onUpdate:modelValue":u[8]||(u[8]=t=>N.value=t),"max-width":"500px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[Kt]),_:1}),e(ne,null,{default:l(()=>[e(Ke,{taskId:C.value,showChatModal:M.value,userId:B.value,"onUpdate:showChatModal":u[6]||(u[6]=t=>M.value=t)},null,8,["taskId","showChatModal","userId"])]),_:1}),e(Fe,null,{default:l(()=>[e(T,{color:"blue darken-1",text:"",onClick:u[7]||(u[7]=t=>N.value=!1)},{default:l(()=>[Wt]),_:1}),e(T,{color:"blue darken-1",text:"",onClick:g},{default:l(()=>[Xt]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Et,{taskId:C.value,showAttachmentsModal:j.value,"onUpdate:showAttachmentsModal":u[9]||(u[9]=t=>j.value=t)},null,8,["taskId","showAttachmentsModal"])]))}};export{aa as default};
