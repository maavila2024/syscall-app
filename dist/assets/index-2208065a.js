import{F as Ce,E as yl,i as gl,j as tl,N as Vl,k as hl,l as xl}from"./vue-tabler-icons.es-4e540416.js";import{u as ze,aq as kl,I as wl,a6 as $e,B as Y,J as i,K as Je,U as ie,o as y,c as O,a as d,b as e,w as l,e as le,d as j,t as X,ar as De,l as ue,V as M,y as t,as as z,m as he,at as Se,P as xe,F as Te,q as je,i as Cl,au as Sl,z as _e,S as Ye,T as Ze,p as ce,av as el,aa as Ul,N as Be,O as Ge,ab as Le,aw as se,ac as ae,an as al,ax as ol,ay as sl,ad as nl,a3 as qe,a7 as h,a1 as u,af as S,ae as Z,az as ne,aA as ul,W as He,ag as Ke,aB as Re,ao as il,aC as Oe,a8 as $l,a9 as Ne,r as Tl,ak as be,al as re,aj as de,G as ql,j as Al,aD as Fe,ai as ve,ah as Ue,aE as Il,aF as Ee,X as Ml,am as jl}from"./index-f3a8f3ae.js";import{u as ke}from"./tasks-886e318f.js";import{_ as We}from"./_plugin-vue_export-helper-c27b6911.js";import{a as V,u as Xe}from"./vee-validate.esm-f29a4fe7.js";const ye=$=>(Be("data-v-bc7ad81a"),$=$(),Ge(),$),Fl={class:"tasks-table-container"},Pl={class:"table-wrapper"},Dl=j(" Chamado "),Rl=j(" Sequência "),Ol=j(" Título "),Nl={class:"text-left",style:{width:"175px"}},El=j(" Solicitante "),zl={class:"text-left",style:{width:"185px"}},Jl=j(" Responsável "),Bl={class:"text-left",style:{width:"135px"}},Gl=j(" Status "),Ll={class:"text-left",style:{width:"165px"}},Hl=j(" Prioridade "),Kl={class:"text-left",style:{width:"235px"}},Wl=j(" Complexidade "),Xl=ye(()=>d("th",{class:"text-left",style:{width:"100px"}},"Ações",-1)),Ql=ye(()=>d("th",null,null,-1)),Yl={key:0},Zl=ye(()=>d("td",null,null,-1)),et=ye(()=>d("td",null,null,-1)),lt=ye(()=>d("td",null,null,-1)),tt={key:0},at={key:1},ot={key:2},st={key:3},nt={key:4},ut={key:5},it={key:6},dt={key:7},rt={key:8},mt={key:9},ct=ye(()=>d("td",null,null,-1)),vt=ye(()=>d("td",null,null,-1)),pt={class:"text-clamp"},ft=j("Default"),_t={class:"text-clamp"},bt={class:"text-clamp"},yt={class:"text-right"},gt={class:"d-flex align-center"},Vt={class:"text-clamp"},ht={class:"text-right"},xt={class:"d-flex align-center"},kt={class:"text-clamp"},wt={class:"text-right"},Ct={class:"d-flex align-center"},St={setup($){const U=ze(),s=ke(),v=kl();wl();const{tasks:J,toShow:N,toEdit:E,toDelete:f,taskFiles:G}=$e(s),T=Y(()=>U.user.teams.some(b=>b.is_admin)),q=i([]),A=i([]),L=i([]),P=i([]),x=i([]),B=i(!1),H=i(!1),K=i(!1),W=i(!1),I=i(!1),k=Y(()=>[...new Set(J.value.map(b=>b.task_status.name))]),D=Y(()=>[...new Set(J.value.map(b=>b.user_owner.first_name))]),C=Y(()=>[...new Set(J.value.map(b=>{var m;return((m=b.user_responsible)==null?void 0:m.first_name)||"Nenhum responsável"}))]),R=Y(()=>[...new Set(J.value.map(b=>b.priority.name))]),F=Y(()=>[...new Set(J.value.map(b=>b.complexity.name))]),g=i(!1),a=i(!1),n=i(!1),c=i(!1),w=i(!1),_=()=>{g.value=q.value.length===k.value.length},te=()=>{a.value=A.value.length===D.value.length},we=()=>{n.value=L.value.length===C.value.length},ge=()=>{c.value=P.value.length===R.value.length},Ae=()=>{w.value=x.value.length===F.value.length},Q=()=>{g.value?q.value=[]:q.value=[...k.value]},r=()=>{a.value?A.value=[]:A.value=[...D.value]},p=()=>{n.value?L.value=[]:L.value=[...C.value]},vl=()=>{c.value?P.value=[]:P.value=[...R.value]},pl=()=>{w.value?x.value=[]:x.value=[...F.value]},pe=i(""),me=i("asc"),Pe=b=>{pe.value===b?me.value=me.value==="asc"?"desc":"asc":(pe.value=b,me.value="asc")},fl=Y(()=>{const b=[...J.value];return b.sort((m,o)=>{const Ve=m[pe.value],fe=o[pe.value];return Ve<fe?me.value==="asc"?-1:1:Ve>fe?me.value==="asc"?1:-1:0}),b}),_l=Y(()=>J.value?fl.value.filter(b=>{var ee,oe,Qe;if(!b)return!1;const m=q.value.length===0||q.value.includes(b.task_status.name),o=A.value.length===0||A.value.includes(b.user_owner.first_name),Ve=L.value.length===0||L.value.includes(((ee=b.user_responsible)==null?void 0:ee.first_name)||"Nenhum responsável"),fe=P.value.length===0||P.value.includes(b.priority.name),Ie=x.value.length===0||x.value.includes(b.complexity.name),Me=((oe=U.user)==null?void 0:oe.default_segment)==0||b.segment==((Qe=U.user)==null?void 0:Qe.default_segment);return m&&o&&Ve&&fe&&Ie&&Me}):[]),bl=b=>({color:b.color});return Je(()=>{const b=v.query.search||"";s.getTasks(b)}),ie(()=>v.query.search,b=>{const m=b||"";s.getTasks(m)}),(b,m)=>(y(),O("div",Fl,[d("div",Pl,[e(Ul,{class:"border-opacity-100"},{default:l(()=>[d("thead",null,[d("tr",null,[d("th",{class:"text-left",style:{width:"50px"},onClick:m[0]||(m[0]=o=>Pe("task_code"))},[Dl,pe.value==="task_code"?(y(),le(De,{key:0},{default:l(()=>[j(X(me.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):ue("",!0)]),d("th",{class:"text-left",style:{width:"50px"},onClick:m[1]||(m[1]=o=>Pe("sequence"))},[Rl,pe.value==="sequence"?(y(),le(De,{key:0},{default:l(()=>[j(X(me.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):ue("",!0)]),d("th",{class:"text-left",style:{width:"50px"},onClick:m[2]||(m[2]=o=>Pe("name"))},[Ol,pe.value==="name"?(y(),le(De,{key:0},{default:l(()=>[j(X(me.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):ue("",!0)]),d("th",Nl,[El,e(M,{icon:"",onClick:m[3]||(m[3]=o=>H.value=!H.value)},{default:l(()=>[e(t(Ce))]),_:1})]),d("th",zl,[Jl,e(M,{icon:"",onClick:m[4]||(m[4]=o=>K.value=!K.value)},{default:l(()=>[e(t(Ce))]),_:1})]),d("th",Bl,[Gl,e(M,{icon:"",onClick:m[5]||(m[5]=o=>B.value=!B.value)},{default:l(()=>[e(t(Ce))]),_:1})]),d("th",Ll,[Hl,e(M,{icon:"",onClick:m[6]||(m[6]=o=>W.value=!W.value)},{default:l(()=>[e(t(Ce))]),_:1})]),d("th",Kl,[Wl,e(M,{icon:"",onClick:m[7]||(m[7]=o=>I.value=!I.value)},{default:l(()=>[e(t(Ce))]),_:1})]),Xl,Ql])]),d("tbody",null,[H.value||K.value||B.value||W.value||I.value?(y(),O("tr",Yl,[Zl,et,lt,H.value?(y(),O("td",tt,[e(z,{modelValue:A.value,"onUpdate:modelValue":m[9]||(m[9]=o=>A.value=o),items:t(D),label:"Filtro Solicitante",multiple:"",onChange:te},{"prepend-item":l(()=>[e(he,null,{default:l(()=>[e(Se,{modelValue:a.value,"onUpdate:modelValue":m[8]||(m[8]=o=>a.value=o),label:a.value?"Desmarcar todos":"Selecionar todos",onChange:r},null,8,["modelValue","label"])]),_:1}),e(xe)]),_:1},8,["modelValue","items"])])):(y(),O("td",at)),K.value?(y(),O("td",ot,[e(z,{modelValue:L.value,"onUpdate:modelValue":m[11]||(m[11]=o=>L.value=o),items:t(C),label:"Filtro Responsável",multiple:"",onChange:we},{"prepend-item":l(()=>[e(he,null,{default:l(()=>[e(Se,{modelValue:n.value,"onUpdate:modelValue":m[10]||(m[10]=o=>n.value=o),label:n.value?"Desmarcar todos":"Selecionar todos",onChange:p},null,8,["modelValue","label"])]),_:1}),e(xe)]),_:1},8,["modelValue","items"])])):(y(),O("td",st)),B.value?(y(),O("td",nt,[e(z,{modelValue:q.value,"onUpdate:modelValue":m[13]||(m[13]=o=>q.value=o),items:t(k),label:"Filtro Status",multiple:"",onChange:_},{"prepend-item":l(()=>[e(he,null,{default:l(()=>[e(Se,{modelValue:g.value,"onUpdate:modelValue":m[12]||(m[12]=o=>g.value=o),label:g.value?"Desmarcar todos":"Selecionar todos",onChange:Q},null,8,["modelValue","label"])]),_:1}),e(xe)]),_:1},8,["modelValue","items"])])):(y(),O("td",ut)),W.value?(y(),O("td",it,[e(z,{modelValue:P.value,"onUpdate:modelValue":m[15]||(m[15]=o=>P.value=o),items:t(R),label:"Filtro Prioridade",multiple:"",onChange:ge},{"prepend-item":l(()=>[e(he,null,{default:l(()=>[e(Se,{modelValue:c.value,"onUpdate:modelValue":m[14]||(m[14]=o=>c.value=o),label:c.value?"Desmarcar todos":"Selecionar todos",onChange:vl},null,8,["modelValue","label"])]),_:1}),e(xe)]),_:1},8,["modelValue","items"])])):(y(),O("td",dt)),I.value?(y(),O("td",rt,[e(z,{modelValue:x.value,"onUpdate:modelValue":m[17]||(m[17]=o=>x.value=o),items:t(F),label:"Filtro Complexidade",multiple:"",onChange:Ae},{"prepend-item":l(()=>[e(he,null,{default:l(()=>[e(Se,{modelValue:w.value,"onUpdate:modelValue":m[16]||(m[16]=o=>w.value=o),label:w.value?"Desmarcar todos":"Selecionar todos",onChange:pl},null,8,["modelValue","label"])]),_:1}),e(xe)]),_:1},8,["modelValue","items"])])):(y(),O("td",mt)),ct,vt])):ue("",!0),(y(!0),O(Te,null,je(t(_l),(o,Ve)=>{var fe,Ie,Me;return y(),O("tr",{key:(o==null?void 0:o.id)||Ve},[d("td",null,X(o==null?void 0:o.task_code),1),d("td",null,X(o==null?void 0:o.sequence),1),d("td",null,[d("div",pt,X(o==null?void 0:o.name),1),o!=null&&o.default?(y(),le(Cl,{key:0,size:"small",variant:"tonal",color:"primary",class:"ml-2"},{default:l(()=>[ft]),_:1})):ue("",!0)]),d("td",null,[d("div",_t,X((fe=o==null?void 0:o.user_owner)==null?void 0:fe.first_name),1)]),d("td",null,[d("div",bt,X(((Ie=o==null?void 0:o.user_responsible)==null?void 0:Ie.first_name)||"Nenhum responsável"),1)]),d("td",null,[d("div",{class:"text-clamp",style:Sl(bl(o==null?void 0:o.task_status))},X((Me=o==null?void 0:o.task_status)==null?void 0:Me.name),5)]),d("td",yt,[d("div",gt,[e(_e,{text:o==null?void 0:o.priority_justification},{activator:l(({props:ee})=>[e(M,Ye(Ze(ee)),{default:l(()=>{var oe;return[d("span",ce(b.attrs,el(b.on)),[d("div",Vt,X((oe=o==null?void 0:o.priority)==null?void 0:oe.name),1)],16)]}),_:2},1040)]),_:2},1032,["text"])])]),d("td",ht,[d("div",xt,[e(_e,{text:(o==null?void 0:o.complexity_justification)||"Aguardando análise"},{activator:l(({props:ee})=>[e(M,Ye(Ze(ee)),{default:l(()=>{var oe;return[d("span",ce(b.attrs,el(b.on)),[d("div",kt,X(((oe=o==null?void 0:o.complexity)==null?void 0:oe.name)||"Aguardando análise"),1)],16)]}),_:2},1040)]),_:2},1032,["text"])])]),d("td",wt,[d("div",Ct,[e(_e,{text:"Visualizar Chamado"},{activator:l(({props:ee})=>[e(M,ce({icon:"",flat:"",onClick:oe=>N.value=o},ee),{default:l(()=>[e(t(yl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),t(T)?(y(),le(_e,{key:0,text:"Editar Chamado"},{activator:l(({props:ee})=>[e(M,ce({icon:"",flat:"",onClick:oe=>E.value=o},ee),{default:l(()=>[e(t(gl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024)):ue("",!0),t(T)?(y(),le(_e,{key:1,text:"Deletar Chamado"},{activator:l(({props:ee})=>[e(M,ce({icon:"",flat:"",onClick:oe=>f.value=o},ee),{default:l(()=>[e(t(tl),{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1024)):ue("",!0),e(_e,{text:"Consultar Notas de Trabalho"},{activator:l(({props:ee})=>[e(M,ce({icon:"",flat:"",onClick:oe=>b.$emit("openChat",o)},ee),{default:l(()=>[e(t(Vl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),e(_e,{text:"Anexos"},{activator:l(({props:ee})=>[e(M,ce({icon:"",flat:"",onClick:oe=>b.$emit("openAttachments",o)},ee),{default:l(()=>[e(t(hl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024)])])])}),128))])]),_:1})])]))}},Ut=We(St,[["__scopeId","data-v-bc7ad81a"]]),$t={emits:["cancel","add"],setup($,{emit:U}){const s=ze(),v=ke();i([]);const J=[{label:"Grãos",value:1},{label:"Proteína",value:2}],N=[{label:"Algo que funcionava, parou de funcionar?",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)?",value:2}],E=Y(()=>{var g;return((g=v.priori.find(a=>a.is_default))==null?void 0:g.id)||null}),f=Y(()=>{var g;return((g=v.taskStatus.find(a=>a.is_default))==null?void 0:g.id)||null}),{value:G}=V("segment",2),{value:T}=V("priority_id"),{value:q}=V("task_status_id");Je(()=>{E.value&&!T.value&&(T.value=E.value),f.value&&!q.value&&(q.value=f.value)});const A=Y(()=>{const g=v.priori.find(a=>a.id===T.value);return g&&g.justify}),L=Y(()=>Le({segment:se().required().label("Segmento"),task_type:se().required().label("Tipo de chamado"),name:ae().required().label("Título"),system_screen:ae().required().label("Tela"),description:ae().required().label("Descrição"),owner_id:se().required().label("Solicitante"),task_status_id:se().required().label("Status do Chamado"),priority_id:se().required().label("Prioridade"),observation:ae().nullable().label("Observação"),priority_justification:A.value?ae().required().label("Justificativa da Prioridade"):ae().label("Justificativa da Prioridade"),status:al().required().label("Status"),files:ol().of(sl()).nullable()})),{handleSubmit:P,errors:x,isSubmitting:B}=Xe({validationSchema:L,initialValues:{segment:1,task_type:"",name:"",system_screen:"",description:"",owner_id:s.user.id,responsible_id:"",task_status_id:f.value,priority_id:E.value,observation:"",created_at:"",expected_date:"",finish_date:"",priority_justification:"",status:!0,files:[]}}),H=P(async g=>{console.log("priority_id at submit:",T.value),console.log("values before sending:",g),g.priority_id=T.value;try{const a=F.value,n=await v.storeTask(g,a);U("add")}catch(a){console.error("Erro ao adicionar comentário ou fazer upload dos arquivos:",a)}}),K=i(""),{value:W}=V("name"),{value:I}=V("task_type"),{value:k}=V("system_screen"),{value:D}=V("description");V("owner_id"),V("responsible_id");const{value:C}=V("observation");V("created_at"),V("expected_date"),V("finish_date");const{value:R}=V("priority_justification");V("status");const{value:F}=V("files");return ie(E,g=>{g&&!T.value&&(T.value=g)}),ie(f,g=>{g&&!q.value&&(q.value=g)}),ie(T,g=>{console.log("priority_id changed to:",g),A.value||(R.value="")}),(g,a)=>(y(),O("div",null,[K.value?(y(),le(nl,{key:0,color:"error",class:"mb-2"},{default:l(()=>[j(X(K.value),1)]),_:1})):ue("",!0),e(Ke,{onSubmit:He(t(H),["prevent"])},{default:l(()=>[e(qe,null,{default:l(()=>[e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(G),"onUpdate:modelValue":a[0]||(a[0]=n=>S(G)?G.value=n:null),"error-messages":t(x).segment,items:J,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(I),"onUpdate:modelValue":a[1]||(a[1]=n=>S(I)?I.value=n:null),"error-messages":t(x).task_type,items:N,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(Z,{modelValue:t(W),"onUpdate:modelValue":a[2]||(a[2]=n=>S(W)?W.value=n:null),"error-messages":t(x).name,label:"Título",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(Z,{modelValue:t(k),"onUpdate:modelValue":a[3]||(a[3]=n=>S(k)?k.value=n:null),"error-messages":t(x).system_screen,label:"Tela",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ne,{modelValue:t(D),"onUpdate:modelValue":a[4]||(a[4]=n=>S(D)?D.value=n:null),"error-messages":t(x).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ne,{modelValue:t(C),"onUpdate:modelValue":a[5]||(a[5]=n=>S(C)?C.value=n:null),"error-messages":t(x).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12",md:"12"},{default:l(()=>[e(z,{modelValue:t(T),"onUpdate:modelValue":a[6]||(a[6]=n=>S(T)?T.value=n:null),"error-messages":t(x).priority_id,items:t(v).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),t(A)?(y(),le(h,{key:0},{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ne,{modelValue:t(R),"onUpdate:modelValue":a[7]||(a[7]=n=>S(R)?R.value=n:null),"error-messages":t(x).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})):ue("",!0),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ul,{modelValue:t(F),"onUpdate:modelValue":a[8]||(a[8]=n=>S(F)?F.value=n:null),label:"Anexos do chamado",multiple:"","error-messages":t(x).files,"show-size":""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,{justify:"end"},{default:l(()=>[e(u,{cols:"12",md:"auto"},{default:l(()=>[e(M,{flat:"",text:"Cancelar",onClick:a[9]||(a[9]=n=>U("cancel"))})]),_:1}),e(u,{cols:"12",md:"auto"},{default:l(()=>[e(M,{type:"submit",color:"primary",flat:"",loading:t(B),text:"Adicionar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},Tt={props:{task:{type:Object,required:!0}},emits:["cancel","edit"],setup($,{emit:U}){const s=$,v=ke(),J=[{label:"Grãos",value:1},{label:"Proteína",value:2}],N=[{label:"Algo que funcionava, parou de funcionar?",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)?",value:2}],{handleSubmit:E,errors:f,isSubmitting:G,setFieldValue:T,setErrors:q}=Xe({validationSchema:Le({segment:se().required().label("Segmento"),task_type:se().required().label("Tipo de chamado"),task_code:ae().required().label("Número do chamado"),name:ae().required().label("Título"),system_screen:ae().required().label("Tela"),sequence:se().nullable().label("Sequência"),description:ae().required().label("Descrição"),owner_id:se().required().label("Solicitante"),responsible_id:se().required().label("Responsável"),task_status_id:se().required().label("Status do Chamado"),priority_id:se().required().label("Prioridade do Chamado"),complexity_id:se().required().label("Complexidade do Chamado"),observation:ae().nullable().label("Observação"),created_at:Re().nullable().label("Data de Criação"),expected_date:Re().nullable().label("Data de Criação").transform((Q,r)=>r===""?null:Q),finish_date:Re().nullable().label("Data de Conclusão").transform((Q,r)=>r===""?null:Q),priority_justification:ae().nullable().label("Justificativa da Prioridade"),complexity_justification:ae().nullable().label("Justificativa da Complexidade"),status:al().required().label("Status")}),initialValues:{segment:s.task.segment,task_type:s.task.task_type,task_code:s.task.task_code,name:s.task.name,description:s.task.description,owner_id:s.task.owner_id,responsible_id:s.task.responsible_id,task_status_id:s.task.task_status_id,system_screen:s.task.system_screen,sequence:s.task.sequence,observation:s.task.observation,priority_id:s.task.priority_id,complexity_id:s.task.complexity_id,priority_justification:s.task.priority_justification,complexity_justification:s.task.complexity_justification,finish_date:s.task.finish_date?s.task.finish_date.split("T")[0]:null,expected_date:s.task.expected_date?s.task.expected_date.split("T")[0]:null,created_at:s.task.created_at?s.task.created_at.split("T")[0]:null,status:s.task.status}}),A={complexityRef:i(null),complexityJustificationRef:i(null),responsibleRef:i(null)},L=()=>{f.responsible_id?Oe(()=>{A.responsibleRef.value.focus(),A.responsibleRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})}):f.complexity_id?Oe(()=>{A.complexityRef.value.focus(),A.complexityRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})}):f.complexity_justification&&Oe(()=>{A.complexityJustificationRef.value.focus(),A.complexityJustificationRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})})};ie(f,Q=>{console.log(f),L()});const P=E(async Q=>{Ae.value||delete Q.priority_justification,_.value||(Q.expected_date=null),te.value||(Q.finish_date=null),console.log("Payload being sent to the backend:",Q),await v.updateTask(s.task.id,Q),U("edit")}),x=i(""),{value:B}=V("segment"),{value:H}=V("priority_id"),{value:K}=V("complexity_id"),{value:W}=V("name"),{value:I}=V("task_code"),{value:k}=V("task_type"),{value:D}=V("description"),{value:C}=V("owner_id"),{value:R}=V("responsible_id"),{value:F}=V("task_status_id"),{value:g}=V("system_screen"),{value:a}=V("sequence"),{value:n}=V("observation"),{value:c}=V("priority_justification"),{value:w}=V("complexity_justification"),{value:_}=V("expected_date"),{value:te}=V("finish_date"),{value:we}=V("created_at"),{value:ge}=V("status"),Ae=Y(()=>{const Q=v.priori.find(r=>r.id===H.value);return Q&&Q.justify});return ie(H,Q=>{Ae.value?T("priority_justification",c.value||""):(c.value="",q({priority_justification:void 0}))}),(Q,r)=>(y(),O("div",null,[x.value?(y(),le(nl,{key:0,color:"error",class:"mb-2"},{default:l(()=>[j(X(x.value),1)]),_:1})):ue("",!0),e(Ke,{onSubmit:He(t(P),["prevent"])},{default:l(()=>[e(qe,null,{default:l(()=>[e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(B),"onUpdate:modelValue":r[0]||(r[0]=p=>S(B)?B.value=p:null),"error-messages":t(f).segment,items:J,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(k),"onUpdate:modelValue":r[1]||(r[1]=p=>S(k)?k.value=p:null),"error-messages":t(f).task_type,items:N,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:t(I),"onUpdate:modelValue":r[2]||(r[2]=p=>S(I)?I.value=p:null),"error-messages":t(f).task_code,label:"Número do chamado",variant:"outlined",color:"primary",disabled:""},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:t(W),"onUpdate:modelValue":r[3]||(r[3]=p=>S(W)?W.value=p:null),"error-messages":t(f).name,label:"Título",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:t(g),"onUpdate:modelValue":r[4]||(r[4]=p=>S(g)?g.value=p:null),"error-messages":t(f).system_screen,label:"Tela",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:t(a),"onUpdate:modelValue":r[5]||(r[5]=p=>S(a)?a.value=p:null),"error-messages":t(f).sequence,label:"Sequência",variant:"outlined",color:"primary",maxlength:"10",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ne,{modelValue:t(D),"onUpdate:modelValue":r[6]||(r[6]=p=>S(D)?D.value=p:null),"error-messages":t(f).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(C),"onUpdate:modelValue":r[7]||(r[7]=p=>S(C)?C.value=p:null),"error-messages":t(f).owner_id,items:t(v).users,label:"Solicitante","item-title":"first_name","item-value":"id",disabled:""},null,8,["modelValue","error-messages","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:t(we),"onUpdate:modelValue":r[8]||(r[8]=p=>S(we)?we.value=p:null),"error-messages":t(f).created_at,label:"Data de Criação",variant:"outlined",type:"date",disabled:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(F),"onUpdate:modelValue":r[9]||(r[9]=p=>S(F)?F.value=p:null),"error-messages":t(f).task_status_id,items:t(v).taskStatus,label:"Status do Chamado","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(R),"onUpdate:modelValue":r[10]||(r[10]=p=>S(R)?R.value=p:null),"error-messages":t(f).responsible_id,items:t(v).users,label:"Responsável","item-title":"first_name","item-value":"id",ref:"responsibleRef"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ne,{modelValue:t(n),"onUpdate:modelValue":r[11]||(r[11]=p=>S(n)?n.value=p:null),"error-messages":t(f).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:t(_),"onUpdate:modelValue":r[12]||(r[12]=p=>S(_)?_.value=p:null),"error-messages":t(f).expected_date,label:"Data Esperada",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:t(te),"onUpdate:modelValue":r[13]||(r[13]=p=>S(te)?te.value=p:null),"error-messages":t(f).finish_date,label:"Data de Conclusão",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(H),"onUpdate:modelValue":r[14]||(r[14]=p=>S(H)?H.value=p:null),"error-messages":t(f).priority_id,items:t(v).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(ne,{modelValue:t(c),"onUpdate:modelValue":r[15]||(r[15]=p=>S(c)?c.value=p:null),"error-messages":t(f).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:t(K),"onUpdate:modelValue":r[16]||(r[16]=p=>S(K)?K.value=p:null),"error-messages":t(f).complexity_id,items:t(v).complexity,label:"Complexidade do Chamado","item-title":"name","item-value":"id",ref:"complexityRef"},null,8,["modelValue","error-messages","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(ne,{modelValue:t(w),"onUpdate:modelValue":r[17]||(r[17]=p=>S(w)?w.value=p:null),"error-messages":t(f).complexity_justification,label:"Justificativa da Complexidade",variant:"outlined",color:"primary",rows:"5",ref:"complexityJustificationRef",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(il,{modelValue:t(ge),"onUpdate:modelValue":r[18]||(r[18]=p=>S(ge)?ge.value=p:null),label:t(ge)?"Ativo":"Inativo",color:"primary",inset:""},null,8,["modelValue","label"])]),_:1})]),_:1}),e(h,{justify:"end"},{default:l(()=>[e(u,{cols:"12",md:"auto"},{default:l(()=>[e(M,{flat:"",text:"Cancelar",onClick:r[19]||(r[19]=p=>U("cancel"))})]),_:1}),e(u,{cols:"12",md:"auto"},{default:l(()=>[e(M,{type:"submit",color:"primary",flat:"",loading:t(G),text:"Editar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},qt={props:{task:{type:Object,required:!0}},emits:["cancel"],setup($,{emit:U}){const s=$,v=ke(),J=[{label:"Grãos",value:1},{label:"Proteína",value:2}],N=[{label:"Algo que funcionava, parou de funcionar!",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)!",value:2}],E=i(s.task.segment),f=i(s.task.task_type),G=i(s.task.task_code),T=i(s.task.name),q=i(s.task.description),A=i(s.task.owner_id),L=i(s.task.responsible_id),P=i(s.task.task_status_id),x=i(s.task.system_screen),B=i(s.task.sequence),H=i(s.task.observation),K=i(s.task.priority_id),W=i(s.task.complexity_id),I=i(s.task.priority_justification),k=i(s.task.complexity_justification),D=i(s.task.finish_date?s.task.finish_date.split("T")[0]:null),C=i(s.task.expected_date?s.task.expected_date.split("T")[0]:null),R=i(s.task.created_at?s.task.created_at.split("T")[0]:null),F=i(s.task.status);return(g,a)=>(y(),O("div",null,[e(qe,null,{default:l(()=>[e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=n=>E.value=n),items:J,label:"Segmento","item-title":"label","item-value":"value",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=n=>f.value=n),items:N,label:"Tipo de chamado","item-title":"label","item-value":"value",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:G.value,"onUpdate:modelValue":a[2]||(a[2]=n=>G.value=n),label:"Número do chamado",variant:"outlined",color:"primary",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:T.value,"onUpdate:modelValue":a[3]||(a[3]=n=>T.value=n),label:"Título",variant:"outlined",color:"primary",readonly:"",class:"custom-label",rows:"2",maxlength:"60"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:x.value,"onUpdate:modelValue":a[4]||(a[4]=n=>x.value=n),label:"Tela",variant:"outlined",color:"primary",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:B.value,"onUpdate:modelValue":a[5]||(a[5]=n=>B.value=n),label:"Sequência",variant:"outlined",color:"primary",maxlength:"10",counter:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ne,{modelValue:q.value,"onUpdate:modelValue":a[6]||(a[6]=n=>q.value=n),label:"Descrição",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"150",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:A.value,"onUpdate:modelValue":a[7]||(a[7]=n=>A.value=n),items:t(v).users,label:"Solicitante","item-title":"first_name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:R.value,"onUpdate:modelValue":a[8]||(a[8]=n=>R.value=n),label:"Data de Criação",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:P.value,"onUpdate:modelValue":a[9]||(a[9]=n=>P.value=n),items:t(v).taskStatus,label:"Status do Chamado","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:L.value,"onUpdate:modelValue":a[10]||(a[10]=n=>L.value=n),items:t(v).users,label:"Responsável","item-title":"first_name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(ne,{modelValue:H.value,"onUpdate:modelValue":a[11]||(a[11]=n=>H.value=n),label:"Observação",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:C.value,"onUpdate:modelValue":a[12]||(a[12]=n=>C.value=n),label:"Data Esperada",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(Z,{modelValue:D.value,"onUpdate:modelValue":a[13]||(a[13]=n=>D.value=n),label:"Data de Conclusão",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:K.value,"onUpdate:modelValue":a[14]||(a[14]=n=>K.value=n),items:t(v).priori,label:"Prioridade","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(ne,{modelValue:I.value,"onUpdate:modelValue":a[15]||(a[15]=n=>I.value=n),label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(z,{modelValue:W.value,"onUpdate:modelValue":a[16]||(a[16]=n=>W.value=n),items:t(v).complexity,label:"Complexidade do Chamado","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(ne,{modelValue:k.value,"onUpdate:modelValue":a[17]||(a[17]=n=>k.value=n),label:"Justificativa da Complexidade",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(il,{modelValue:F.value,"onUpdate:modelValue":a[18]||(a[18]=n=>F.value=n),label:F.value?"Ativo":"Inativo",color:"primary",inset:"",disabled:""},null,8,["modelValue","label"])]),_:1})]),_:1}),e(h,{justify:"end"},{default:l(()=>[e(u,{cols:"12",md:"auto"},{default:l(()=>[e(M,{flat:"",text:"Fechar",onClick:a[19]||(a[19]=n=>g.$emit("cancel"))})]),_:1})]),_:1})]),_:1})]))}},dl=$l("chats",{state:()=>({messages:[]}),actions:{async fetchMessages($){try{const U=await Ne.get(`/api/interactions/${$}`);this.messages=U.data}catch(U){console.error("Error fetching messages:",U)}},async createInteraction($,U,s){try{return(await Ne.post("/api/interactions",{task_id:$,comment:U,user_id:s})).data}catch(v){console.error("Error creating interaction:",v)}},async uploadFile($){try{return(await Ne.post("/api/interaction-file",$,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(U){throw console.error("Error uploading file:",U),U}}}});function rl($){return`https://syscall-api.devtest.com.br//storage/${$}`}const ml=$=>(Be("data-v-4ff77f2d"),$=$(),Ge(),$),At=ml(()=>d("span",{class:"text-h5"},"Notas de Trabalho",-1)),It={class:"comment-text"},Mt={key:0},jt=["href"],Ft={class:"text-right text-caption mt-2"},Pt={class:"email-text"},Dt=j(" - "),Rt={class:"email-text"},Ot=j("Adicionar Comentário"),Nt=j("Fechar"),Et=ml(()=>d("span",{class:"text-h5"},"Adicionar Comentário",-1)),zt=j("Cancelar"),Jt=j("Adicionar"),Bt={props:{taskId:{type:Number,required:!0},showChatModal:{type:Boolean,required:!0},userId:{type:Number,required:!0}},emits:["update:showChatModal"],setup($,{emit:U}){const s=$,v=dl(),{messages:J}=$e(v),N=i(!1),E=i(!1),f=Le({comment:ae().required().label("Comentário"),files:ol().of(sl()).nullable()}),{handleSubmit:G,errors:T,isSubmitting:q,resetForm:A}=Xe({validationSchema:f,initialValues:{comment:"",files:[]}}),L=G(async I=>{try{const k=await v.createInteraction(s.taskId,I.comment,s.userId);if(I.files&&I.files.length>0){const D=new FormData;D.append("interaction_id",k.id);for(const C of I.files)D.append("files[]",C);await v.uploadFile(D)}await v.fetchMessages(s.taskId),E.value=!1,U("update:showChatModal",!1)}catch(k){console.error("Erro ao adicionar comentário ou fazer upload dos arquivos:",k)}}),{value:P}=V("comment"),{value:x}=V("files");ie(()=>s.showChatModal,async I=>{I?(N.value=!0,await v.fetchMessages(s.taskId)):N.value=!1});const B=()=>{U("update:showChatModal",!1)},H=()=>{A(),E.value=!0},K=I=>{const k={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return new Date(I).toLocaleDateString("pt-BR",k)},W=Y(()=>[...J.value].sort((I,k)=>k.id-I.id));return(I,k)=>{const D=Tl("v-list-item-content");return y(),le(ve,{modelValue:N.value,"onUpdate:modelValue":k[4]||(k[4]=C=>N.value=C),"max-width":"800px",persistent:""},{default:l(()=>[e(de,null,{default:l(()=>[e(be,null,{default:l(()=>[At]),_:1}),e(re,null,{default:l(()=>[e(qe,null,{default:l(()=>[e(h,null,{default:l(()=>[(y(!0),O(Te,null,je(t(W),(C,R)=>(y(),le(u,{key:R,cols:"12"},{default:l(()=>[e(de,{class:"mb-3"},{default:l(()=>[e(re,null,{default:l(()=>[d("div",It,X(C.comment),1),C.interaction_files&&C.interaction_files.length?(y(),O("div",Mt,[e(xe),e(ql,null,{default:l(()=>[(y(!0),O(Te,null,je(C.interaction_files,(F,g)=>(y(),le(he,{key:g},{default:l(()=>[e(D,null,{default:l(()=>[e(Al,null,{default:l(()=>[d("a",{href:t(rl)(F.path),target:"_blank"},X(F.name),9,jt)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])):ue("",!0),d("div",Ft,[d("span",Pt,X(C.user_email),1),Dt,d("span",Rt,X(K(C.created_at)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(Fe,null,{default:l(()=>[e(M,{color:"primary",onClick:H},{default:l(()=>[Ot]),_:1}),e(M,{color:"secondary",onClick:B},{default:l(()=>[Nt]),_:1})]),_:1})]),_:1}),e(ve,{modelValue:E.value,"onUpdate:modelValue":k[3]||(k[3]=C=>E.value=C),"max-width":"500px",persistent:""},{default:l(()=>[e(de,null,{default:l(()=>[e(be,null,{default:l(()=>[Et]),_:1}),e(re,null,{default:l(()=>[e(Ke,{onSubmit:He(t(L),["prevent"])},{default:l(()=>[e(ne,{modelValue:t(P),"onUpdate:modelValue":k[0]||(k[0]=C=>S(P)?P.value=C:null),label:"Comentário","error-messages":t(T).comment},null,8,["modelValue","error-messages"]),e(ul,{modelValue:t(x),"onUpdate:modelValue":k[1]||(k[1]=C=>S(x)?x.value=C:null),label:"Selecionar Arquivos","error-messages":t(T).files,"show-size":"",multiple:""},null,8,["modelValue","error-messages"])]),_:1},8,["onSubmit"])]),_:1}),e(Fe,null,{default:l(()=>[e(M,{color:"blue darken-1",text:"",onClick:k[2]||(k[2]=C=>E.value=!1)},{default:l(()=>[zt]),_:1}),e(M,{color:"blue darken-1",text:"",loading:t(q),onClick:t(L)},{default:l(()=>[Jt]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},ll=We(Bt,[["__scopeId","data-v-4ff77f2d"]]),Gt=d("span",{class:"text-h5"},"Anexos do Chamado",-1),Lt=["href"],Ht=j("Fechar"),Kt={props:{taskId:{type:Number,required:!0},showAttachmentsModal:{type:Boolean,required:!0}},emits:["update:showAttachmentsModal"],setup($,{emit:U}){const s=$,v=ke(),{taskFiles:J}=$e(v),N=i(!1);ie(()=>s.showAttachmentsModal,async G=>{G?(await v.getTaskFiles(s.taskId),N.value=!0):N.value=!1});const E=()=>{U("update:showAttachmentsModal",!1)},f=async G=>{await v.deleteTaskFile(G),await v.getTaskFiles(s.taskId)};return(G,T)=>(y(),le(ve,{modelValue:N.value,"onUpdate:modelValue":T[0]||(T[0]=q=>N.value=q),"max-width":"800px",persistent:""},{default:l(()=>[e(de,null,{default:l(()=>[e(be,null,{default:l(()=>[Gt]),_:1}),e(re,null,{default:l(()=>[e(qe,null,{default:l(()=>[e(h,null,{default:l(()=>[(y(!0),O(Te,null,je(t(J),(q,A)=>(y(),le(u,{key:A,cols:"12"},{default:l(()=>[e(de,{class:"mb-3"},{default:l(()=>[e(re,null,{default:l(()=>[d("a",{href:t(rl)(q.path),target:"_blank"},X(q.name),9,Lt),e(M,{icon:"",onClick:L=>f(q.id)},{default:l(()=>[e(t(xl))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(Fe,null,{default:l(()=>[e(M,{color:"secondary",onClick:E},{default:l(()=>[Ht]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};const cl=$=>(Be("data-v-52537761"),$=$(),Ge(),$),Wt={class:"mb-5 pb-5 border-b border-opacity-100"},Xt=cl(()=>d("label",{class:"mr-4"},"Segmento:",-1)),Qt=j("Novo Chamado"),Yt=j("Adicionar chamado"),Zt=j("Visualizar chamado"),ea=j("Editar chamado"),la=j("Cancelar"),ta=j("Deletar"),aa=cl(()=>d("span",{class:"text-h5"},"Adicionar Nota de Trabalho",-1)),oa=j("Cancelar"),sa=j("Adicionar"),na={setup($){var n;const U=ze(),s=ke(),{toShow:v,toEdit:J,toDelete:N}=$e(s),E=dl();$e(E);const{isLoading:f}=Ue(s.getTasks());Ue(s.getPriorities()),Ue(s.getComplexities()),Ue(s.getTasksStatus()),Ue(s.getUsers());const G=Y({get(){return!!Object.keys(J.value).length},set(c){c||(J.value={})}}),T=Y({get(){return!!Object.keys(v.value).length},set(c){c||(v.value={})}}),q=Y({get(){return!!Object.keys(N.value).length},set(c){c||(N.value={})}}),A=i(!1);async function L(c){A.value=!0,await s.deleteTask(c.id),N.value={},A.value=!1}const P=i(!1),x=i(0),B=i(!1),H=i(""),K=i(U.user.id),W=c=>{c&&c.id&&(x.value=c.id,P.value=!0)},I=c=>{c&&c.id&&(x.value=c.id,B.value=!0)},k=async()=>{await E.addMessage(x.value,H.value,K.value),H.value="",B.value=!1},D=i(!1),C=c=>{c&&c.id&&(x.value=c.id,D.value=!0)},R=i(""),F=i(((n=U.user)==null?void 0:n.default_segment)||"0"),g=async()=>{try{await U.updateUserSegment(F.value),a()}catch(c){console.error("Failed to update user segment:",c)}},a=async()=>{const c=R.value||"";await s.getTasks(c,F.value)};return ie(R,a),ie(F,a),Je(()=>{var c,w;F.value=((w=(c=U.user)==null?void 0:c.default_segment)==null?void 0:w.toString())||"0",a()}),ie(R,c=>{s.getTasks(c)}),(c,w)=>(y(),O("div",null,[d("div",Wt,[e(h,{align:"center",justify:"space-between"},{default:l(()=>[e(u,{cols:"12",lg:"3",md:"4"},{default:l(()=>[e(Z,{density:"compact",modelValue:R.value,"onUpdate:modelValue":w[0]||(w[0]=_=>R.value=_),label:"Pesquisar Chamados","append-inner-icon":"mdi-magnify","hide-details":"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(u,{cols:"12",lg:"6",md:"4",class:"d-flex align-center"},{default:l(()=>[Xt,e(Il,{modelValue:F.value,"onUpdate:modelValue":w[1]||(w[1]=_=>F.value=_),onChange:g,row:"",inline:"",class:"radio-button"},{default:l(()=>[e(Ee,{label:"Todos",value:"0",class:"mr-2"}),e(Ee,{label:"Grãos",value:"1",class:"mr-2"}),e(Ee,{label:"Proteína",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(u,{cols:"12",lg:"3",md:"4",class:"text-right"},{default:l(()=>[e(ve,{width:"800",persistent:""},{activator:l(({props:_})=>[e(M,ce({flat:"",color:"primary"},_),{default:l(()=>[Qt]),_:2},1040)]),default:l(({isActive:_})=>[e(de,{width:"800"},{default:l(()=>[e(be,null,{default:l(()=>[Yt]),_:1}),e(re,null,{default:l(()=>[e($t,{onAdd:te=>_.value=!1,onCancel:te=>_.value=!1},null,8,["onAdd","onCancel"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1})]),_:1})]),t(f)?(y(),le(jl,{key:0,width:3,color:"primary",indeterminate:""})):(y(),O(Te,{key:1},[e(Ut,{onOpenChat:W,onAddNote:I,onOpenAttachments:C}),e(ve,{modelValue:t(T),"onUpdate:modelValue":w[2]||(w[2]=_=>S(T)?T.value=_:null),width:"800",persistent:""},{default:l(({isActive:_})=>[e(de,{width:"800"},{default:l(()=>[e(be,null,{default:l(()=>[Zt]),_:1}),e(re,null,{default:l(()=>[e(qt,{task:t(v),onCancel:te=>_.value=!1,onShow:te=>_.value=!1},null,8,["task","onCancel","onShow"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(ve,{modelValue:t(G),"onUpdate:modelValue":w[3]||(w[3]=_=>S(G)?G.value=_:null),width:"800",persistent:""},{default:l(({isActive:_})=>[e(de,{width:"800"},{default:l(()=>[e(be,null,{default:l(()=>[ea]),_:1}),e(re,null,{default:l(()=>[e(Tt,{task:t(J),onCancel:te=>_.value=!1,onEdit:te=>_.value=!1},null,8,["task","onCancel","onEdit"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(ve,{modelValue:t(q),"onUpdate:modelValue":w[5]||(w[5]=_=>S(q)?q.value=_:null),width:"800",persistent:""},{default:l(({isActive:_})=>[e(de,{"prepend-icon":t(tl),title:"Você tem certeza que deseja deletar este chamado?"},{actions:l(()=>[e(Ml),e(M,{onClick:te=>_.value=!1},{default:l(()=>[la]),_:2},1032,["onClick"]),e(M,{onClick:w[4]||(w[4]=te=>L(t(N))),variant:"tonal",color:"error",loading:A.value},{default:l(()=>[ta]),_:1},8,["loading"])]),_:2},1032,["prepend-icon"])]),_:1},8,["modelValue"])],64)),e(ll,{taskId:x.value,showChatModal:P.value,userId:K.value,"onUpdate:showChatModal":w[6]||(w[6]=_=>P.value=_)},null,8,["taskId","showChatModal","userId"]),e(ve,{modelValue:B.value,"onUpdate:modelValue":w[9]||(w[9]=_=>B.value=_),"max-width":"500px",persistent:""},{default:l(()=>[e(de,null,{default:l(()=>[e(be,null,{default:l(()=>[aa]),_:1}),e(re,null,{default:l(()=>[e(ll,{taskId:x.value,showChatModal:P.value,userId:K.value,"onUpdate:showChatModal":w[7]||(w[7]=_=>P.value=_)},null,8,["taskId","showChatModal","userId"])]),_:1}),e(Fe,null,{default:l(()=>[e(M,{color:"blue darken-1",text:"",onClick:w[8]||(w[8]=_=>B.value=!1)},{default:l(()=>[oa]),_:1}),e(M,{color:"blue darken-1",text:"",onClick:k},{default:l(()=>[sa]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Kt,{taskId:x.value,showAttachmentsModal:D.value,"onUpdate:showAttachmentsModal":w[10]||(w[10]=_=>D.value=_)},null,8,["taskId","showAttachmentsModal"])]))}},ca=We(na,[["__scopeId","data-v-52537761"]]);export{ca as default};
