import{F as Se,E as vl,i as pl,j as We,N as fl,k as _l,l as bl}from"./vue-tabler-icons.es-1b6b56fc.js";import{u as Ee,a3 as Te,B as Q,L as r,o as _,c as F,a as d,b as e,w as l,e as W,d as S,t as L,ao as Fe,l as le,V as q,y as a,ap as R,m as ge,aq as $e,I as he,F as qe,q as Pe,i as yl,ar as Vl,z as ve,M as Ge,N as He,p as de,as as Qe,a8 as gl,O as Xe,P as Ye,a4 as hl,a9 as ze,at as ee,aa as Y,al as Ze,au as el,av as ll,Q as me,ab as tl,a0 as Ae,a5 as V,_ as i,ad as w,ac as K,aw as te,ax as al,S as Je,ae as Be,ay as Oe,am as ol,az as Re,a6 as xl,a7 as Ne,r as kl,ai as pe,aj as ue,ah as se,G as wl,j as Cl,aA as De,ag as re,af as Ue,T as Sl,ak as $l}from"./index-c2e1008c.js";import{u as xe}from"./tasks-4a2bf228.js";import{_ as sl}from"./_plugin-vue_export-helper-c27b6911.js";import{a as y,u as Le}from"./vee-validate.esm-a36a519d.js";const fe=A=>(Xe("data-v-d185a282"),A=A(),Ye(),A),Ul={class:"tasks-table-container"},Tl={class:"table-wrapper"},ql=S(" Chamado "),Al=S(" Sequência "),Il=S(" Título "),Ml=S(" Descrição "),jl={class:"text-left",style:{width:"175px"}},Fl=S(" Solicitante "),Pl={class:"text-left",style:{width:"185px"}},Dl=S(" Responsável "),Ol={class:"text-left",style:{width:"135px"}},Rl=S(" Status "),Nl={class:"text-left",style:{width:"165px"}},El=S(" Prioridade "),zl={class:"text-left",style:{width:"235px"}},Jl=S(" Complexidade "),Bl=fe(()=>d("th",{class:"text-left",style:{width:"100px"}},"Ações",-1)),Ll=fe(()=>d("th",null,null,-1)),Gl={key:0},Hl=fe(()=>d("td",null,null,-1)),Ql=fe(()=>d("td",null,null,-1)),Kl=fe(()=>d("td",null,null,-1)),Wl={key:0},Xl={key:1},Yl={key:2},Zl={key:3},et={key:4},lt={key:5},tt={key:6},at={key:7},ot={key:8},st={key:9},nt=fe(()=>d("td",null,null,-1)),ut=fe(()=>d("td",null,null,-1)),it={class:"text-clamp"},dt=S("Default"),rt={class:"text-clamp"},mt={class:"text-clamp"},ct={class:"text-clamp"},vt={class:"text-right"},pt={class:"d-flex align-center"},ft={class:"text-clamp"},_t={class:"text-right"},bt={class:"d-flex align-center"},yt={class:"text-clamp"},Vt={class:"text-right"},gt={class:"d-flex align-center"},ht={setup(A){const I=Ee(),n=xe(),{tasks:c,toShow:X,toEdit:P,toDelete:D,taskFiles:b}=Te(n),O=Q(()=>I.user.teams.some(k=>k.is_admin)),h=r([]),$=r([]),U=r([]),z=r([]),M=r([]),C=r(!1),N=r(!1),J=r(!1),B=r(!1),G=r(!1),T=Q(()=>[...new Set(c.value.map(k=>k.task_status.name))]),g=Q(()=>[...new Set(c.value.map(k=>k.user_owner.first_name))]),j=Q(()=>[...new Set(c.value.map(k=>{var v;return((v=k.user_responsible)==null?void 0:v.first_name)||"Nenhum responsável"}))]),x=Q(()=>[...new Set(c.value.map(k=>k.priority.name))]),E=Q(()=>[...new Set(c.value.map(k=>k.complexity.name))]),p=r(!1),u=r(!1),t=r(!1),s=r(!1),ae=r(!1),ke=()=>{p.value=h.value.length===T.value.length},_e=()=>{u.value=$.value.length===g.value.length},be=()=>{t.value=U.value.length===j.value.length},we=()=>{s.value=z.value.length===x.value.length},ye=()=>{ae.value=M.value.length===E.value.length},Ie=()=>{p.value?h.value=[]:h.value=[...T.value]},H=()=>{u.value?$.value=[]:$.value=[...g.value]},m=()=>{t.value?U.value=[]:U.value=[...j.value]},f=()=>{s.value?z.value=[]:z.value=[...x.value]},dl=()=>{ae.value?M.value=[]:M.value=[...E.value]},ie=r(""),ne=r("asc"),Me=k=>{ie.value===k?ne.value=ne.value==="asc"?"desc":"asc":(ie.value=k,ne.value="asc")},rl=Q(()=>{const k=[...c.value];return k.sort((v,o)=>{const Ve=v[ie.value],ce=o[ie.value];return Ve<ce?ne.value==="asc"?-1:1:Ve>ce?ne.value==="asc"?1:-1:0}),k}),ml=Q(()=>c.value?rl.value.filter(k=>{var Ce;if(!k)return!1;const v=h.value.length===0||h.value.includes(k.task_status.name),o=$.value.length===0||$.value.includes(k.user_owner.first_name),Ve=U.value.length===0||U.value.includes(((Ce=k.user_responsible)==null?void 0:Ce.first_name)||"Nenhum responsável"),ce=z.value.length===0||z.value.includes(k.priority.name),je=M.value.length===0||M.value.includes(k.complexity.name);return v&&o&&Ve&&ce&&je}):[]),cl=k=>({color:k.color});return(k,v)=>(_(),F("div",Ul,[d("div",Tl,[e(gl,{class:"border-opacity-100"},{default:l(()=>[d("thead",null,[d("tr",null,[d("th",{class:"text-left",style:{width:"50px"},onClick:v[0]||(v[0]=o=>Me("task_code"))},[ql,ie.value==="task_code"?(_(),W(Fe,{key:0},{default:l(()=>[S(L(ne.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):le("",!0)]),d("th",{class:"text-left",style:{width:"50px"},onClick:v[1]||(v[1]=o=>Me("sequence"))},[Al,ie.value==="sequence"?(_(),W(Fe,{key:0},{default:l(()=>[S(L(ne.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):le("",!0)]),d("th",{class:"text-left",style:{width:"50px"},onClick:v[2]||(v[2]=o=>Me("name"))},[Il,ie.value==="name"?(_(),W(Fe,{key:0},{default:l(()=>[S(L(ne.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):le("",!0)]),d("th",{class:"text-left",style:{width:"140px"},onClick:v[3]||(v[3]=o=>Me("description"))},[Ml,ie.value==="description"?(_(),W(Fe,{key:0},{default:l(()=>[S(L(ne.value==="asc"?"mdi-arrow-up":"mdi-arrow-down"),1)]),_:1})):le("",!0)]),d("th",jl,[Fl,e(q,{icon:"",onClick:v[4]||(v[4]=o=>N.value=!N.value)},{default:l(()=>[e(a(Se))]),_:1})]),d("th",Pl,[Dl,e(q,{icon:"",onClick:v[5]||(v[5]=o=>J.value=!J.value)},{default:l(()=>[e(a(Se))]),_:1})]),d("th",Ol,[Rl,e(q,{icon:"",onClick:v[6]||(v[6]=o=>C.value=!C.value)},{default:l(()=>[e(a(Se))]),_:1})]),d("th",Nl,[El,e(q,{icon:"",onClick:v[7]||(v[7]=o=>B.value=!B.value)},{default:l(()=>[e(a(Se))]),_:1})]),d("th",zl,[Jl,e(q,{icon:"",onClick:v[8]||(v[8]=o=>G.value=!G.value)},{default:l(()=>[e(a(Se))]),_:1})]),Bl,Ll])]),d("tbody",null,[N.value||J.value||C.value||B.value||G.value?(_(),F("tr",Gl,[Hl,Ql,Kl,N.value?(_(),F("td",Wl,[e(R,{modelValue:$.value,"onUpdate:modelValue":v[10]||(v[10]=o=>$.value=o),items:a(g),label:"Filtro Solicitante",multiple:"",onChange:_e},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e($e,{modelValue:u.value,"onUpdate:modelValue":v[9]||(v[9]=o=>u.value=o),label:u.value?"Desmarcar todos":"Selecionar todos",onChange:H},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(_(),F("td",Xl)),J.value?(_(),F("td",Yl,[e(R,{modelValue:U.value,"onUpdate:modelValue":v[12]||(v[12]=o=>U.value=o),items:a(j),label:"Filtro Responsável",multiple:"",onChange:be},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e($e,{modelValue:t.value,"onUpdate:modelValue":v[11]||(v[11]=o=>t.value=o),label:t.value?"Desmarcar todos":"Selecionar todos",onChange:m},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(_(),F("td",Zl)),C.value?(_(),F("td",et,[e(R,{modelValue:h.value,"onUpdate:modelValue":v[14]||(v[14]=o=>h.value=o),items:a(T),label:"Filtro Status",multiple:"",onChange:ke},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e($e,{modelValue:p.value,"onUpdate:modelValue":v[13]||(v[13]=o=>p.value=o),label:p.value?"Desmarcar todos":"Selecionar todos",onChange:Ie},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(_(),F("td",lt)),B.value?(_(),F("td",tt,[e(R,{modelValue:z.value,"onUpdate:modelValue":v[16]||(v[16]=o=>z.value=o),items:a(x),label:"Filtro Prioridade",multiple:"",onChange:we},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e($e,{modelValue:s.value,"onUpdate:modelValue":v[15]||(v[15]=o=>s.value=o),label:s.value?"Desmarcar todos":"Selecionar todos",onChange:f},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(_(),F("td",at)),G.value?(_(),F("td",ot,[e(R,{modelValue:M.value,"onUpdate:modelValue":v[18]||(v[18]=o=>M.value=o),items:a(E),label:"Filtro Complexidade",multiple:"",onChange:ye},{"prepend-item":l(()=>[e(ge,null,{default:l(()=>[e($e,{modelValue:ae.value,"onUpdate:modelValue":v[17]||(v[17]=o=>ae.value=o),label:ae.value?"Desmarcar todos":"Selecionar todos",onChange:dl},null,8,["modelValue","label"])]),_:1}),e(he)]),_:1},8,["modelValue","items"])])):(_(),F("td",st)),nt,ut])):le("",!0),(_(!0),F(qe,null,Pe(a(ml),(o,Ve)=>{var ce,je,Ce;return _(),F("tr",{key:(o==null?void 0:o.id)||Ve},[d("td",null,L(o==null?void 0:o.task_code),1),d("td",null,L(o==null?void 0:o.sequence),1),d("td",null,[d("div",it,L(o==null?void 0:o.name),1),o!=null&&o.default?(_(),W(yl,{key:0,size:"small",variant:"tonal",color:"primary",class:"ml-2"},{default:l(()=>[dt]),_:1})):le("",!0)]),d("td",null,[d("div",rt,L(o==null?void 0:o.description),1)]),d("td",null,[d("div",mt,L((ce=o==null?void 0:o.user_owner)==null?void 0:ce.first_name),1)]),d("td",null,[d("div",ct,L(((je=o==null?void 0:o.user_responsible)==null?void 0:je.first_name)||"Nenhum responsável"),1)]),d("td",null,[d("div",{class:"text-clamp",style:Vl(cl(o==null?void 0:o.task_status))},L((Ce=o==null?void 0:o.task_status)==null?void 0:Ce.name),5)]),d("td",vt,[d("div",pt,[e(ve,{text:o==null?void 0:o.priority_justification},{activator:l(({props:Z})=>[e(q,Ge(He(Z)),{default:l(()=>{var oe;return[d("span",de(k.attrs,Qe(k.on)),[d("div",ft,L((oe=o==null?void 0:o.priority)==null?void 0:oe.name),1)],16)]}),_:2},1040)]),_:2},1032,["text"])])]),d("td",_t,[d("div",bt,[e(ve,{text:(o==null?void 0:o.complexity_justification)||"Aguardando análise"},{activator:l(({props:Z})=>[e(q,Ge(He(Z)),{default:l(()=>{var oe;return[d("span",de(k.attrs,Qe(k.on)),[d("div",yt,L(((oe=o==null?void 0:o.complexity)==null?void 0:oe.name)||"Aguardando análise"),1)],16)]}),_:2},1040)]),_:2},1032,["text"])])]),d("td",Vt,[d("div",gt,[e(ve,{text:"Visualizar Chamado"},{activator:l(({props:Z})=>[e(q,de({icon:"",flat:"",onClick:oe=>X.value=o},Z),{default:l(()=>[e(a(vl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),a(O)?(_(),W(ve,{key:0,text:"Editar Chamado"},{activator:l(({props:Z})=>[e(q,de({icon:"",flat:"",onClick:oe=>P.value=o},Z),{default:l(()=>[e(a(pl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024)):le("",!0),a(O)?(_(),W(ve,{key:1,text:"Deletar Chamado"},{activator:l(({props:Z})=>[e(q,de({icon:"",flat:"",onClick:oe=>D.value=o},Z),{default:l(()=>[e(a(We),{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1024)):le("",!0),e(ve,{text:"Consultar Notas de Trabalho"},{activator:l(({props:Z})=>[e(q,de({icon:"",flat:"",onClick:oe=>k.$emit("openChat",o)},Z),{default:l(()=>[e(a(fl),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),e(ve,{text:"Anexos"},{activator:l(({props:Z})=>[e(q,de({icon:"",flat:"",onClick:oe=>k.$emit("openAttachments",o)},Z),{default:l(()=>[e(a(_l),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024)])])])}),128))])]),_:1})])]))}},xt=sl(ht,[["__scopeId","data-v-d185a282"]]),kt={emits:["cancel","add"],setup(A,{emit:I}){const n=Ee(),c=xe();r([]);const X=[{label:"Grãos",value:1},{label:"Proteína",value:2}],P=[{label:"Algo que funcionava, parou de funcionar?",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)?",value:2}],D=Q(()=>{var u;return((u=c.priori.find(t=>t.is_default))==null?void 0:u.id)||null}),b=Q(()=>{var u;return((u=c.taskStatus.find(t=>t.is_default))==null?void 0:u.id)||null}),{value:O}=y("segment",2),{value:h}=y("priority_id"),{value:$}=y("task_status_id");hl(()=>{D.value&&!h.value&&(h.value=D.value),b.value&&!$.value&&($.value=b.value)});const U=Q(()=>{const u=c.priori.find(t=>t.id===h.value);return u&&u.justify}),z=Q(()=>ze({segment:ee().required().label("Segmento"),task_type:ee().required().label("Tipo de chamado"),name:Y().required().label("Título"),system_screen:Y().required().label("Tela"),description:Y().required().label("Descrição"),owner_id:ee().required().label("Solicitante"),task_status_id:ee().required().label("Status do Chamado"),priority_id:ee().required().label("Prioridade"),observation:Y().nullable().label("Observação"),priority_justification:U.value?Y().required().label("Justificativa da Prioridade"):Y().label("Justificativa da Prioridade"),status:Ze().required().label("Status"),files:el().of(ll()).nullable()})),{handleSubmit:M,errors:C,isSubmitting:N}=Le({validationSchema:z,initialValues:{segment:1,task_type:"",name:"",system_screen:"",description:"",owner_id:n.user.id,responsible_id:"",task_status_id:b.value,priority_id:D.value,observation:"",created_at:"",expected_date:"",finish_date:"",priority_justification:"",status:!0,files:[]}}),J=M(async u=>{console.log("priority_id at submit:",h.value),console.log("values before sending:",u),u.priority_id=h.value;try{const t=p.value,s=await c.storeTask(u,t);I("add")}catch(t){console.error("Erro ao adicionar comentário ou fazer upload dos arquivos:",t)}}),B=r(""),{value:G}=y("name"),{value:T}=y("task_type"),{value:g}=y("system_screen"),{value:j}=y("description");y("owner_id"),y("responsible_id");const{value:x}=y("observation");y("created_at"),y("expected_date"),y("finish_date");const{value:E}=y("priority_justification");y("status");const{value:p}=y("files");return me(D,u=>{u&&!h.value&&(h.value=u)}),me(b,u=>{u&&!$.value&&($.value=u)}),me(h,u=>{console.log("priority_id changed to:",u),U.value||(E.value="")}),(u,t)=>(_(),F("div",null,[B.value?(_(),W(tl,{key:0,color:"error",class:"mb-2"},{default:l(()=>[S(L(B.value),1)]),_:1})):le("",!0),e(Be,{onSubmit:Je(a(J),["prevent"])},{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(O),"onUpdate:modelValue":t[0]||(t[0]=s=>w(O)?O.value=s:null),"error-messages":a(C).segment,items:X,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(T),"onUpdate:modelValue":t[1]||(t[1]=s=>w(T)?T.value=s:null),"error-messages":a(C).task_type,items:P,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(K,{modelValue:a(G),"onUpdate:modelValue":t[2]||(t[2]=s=>w(G)?G.value=s:null),"error-messages":a(C).name,label:"Título",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(K,{modelValue:a(g),"onUpdate:modelValue":t[3]||(t[3]=s=>w(g)?g.value=s:null),"error-messages":a(C).system_screen,label:"Tela",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(te,{modelValue:a(j),"onUpdate:modelValue":t[4]||(t[4]=s=>w(j)?j.value=s:null),"error-messages":a(C).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(te,{modelValue:a(x),"onUpdate:modelValue":t[5]||(t[5]=s=>w(x)?x.value=s:null),"error-messages":a(C).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12",md:"12"},{default:l(()=>[e(R,{modelValue:a(h),"onUpdate:modelValue":t[6]||(t[6]=s=>w(h)?h.value=s:null),"error-messages":a(C).priority_id,items:a(c).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),a(U)?(_(),W(V,{key:0},{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(te,{modelValue:a(E),"onUpdate:modelValue":t[7]||(t[7]=s=>w(E)?E.value=s:null),"error-messages":a(C).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})):le("",!0),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(al,{modelValue:a(p),"onUpdate:modelValue":t[8]||(t[8]=s=>w(p)?p.value=s:null),label:"Anexos do chamado",multiple:"","error-messages":a(C).files,"show-size":""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,{justify:"end"},{default:l(()=>[e(i,{cols:"12",md:"auto"},{default:l(()=>[e(q,{flat:"",text:"Cancelar",onClick:t[9]||(t[9]=s=>I("cancel"))})]),_:1}),e(i,{cols:"12",md:"auto"},{default:l(()=>[e(q,{type:"submit",color:"primary",flat:"",loading:a(N),text:"Adicionar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},wt={props:{task:{type:Object,required:!0}},emits:["cancel","edit"],setup(A,{emit:I}){const n=A,c=xe(),X=[{label:"Grãos",value:1},{label:"Proteína",value:2}],P=[{label:"Algo que funcionava, parou de funcionar?",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)?",value:2}],{handleSubmit:D,errors:b,isSubmitting:O,setFieldValue:h,setErrors:$}=Le({validationSchema:ze({segment:ee().required().label("Segmento"),task_type:ee().required().label("Tipo de chamado"),task_code:Y().required().label("Número do chamado"),name:Y().required().label("Título"),system_screen:Y().required().label("Tela"),sequence:ee().nullable().label("Sequência"),description:Y().required().label("Descrição"),owner_id:ee().required().label("Solicitante"),responsible_id:ee().required().label("Responsável"),task_status_id:ee().required().label("Status do Chamado"),priority_id:ee().required().label("Prioridade do Chamado"),complexity_id:ee().required().label("Complexidade do Chamado"),observation:Y().nullable().label("Observação"),created_at:Oe().nullable().label("Data de Criação"),expected_date:Oe().nullable().label("Data de Criação").transform((H,m)=>m===""?null:H),finish_date:Oe().nullable().label("Data de Conclusão").transform((H,m)=>m===""?null:H),priority_justification:Y().nullable().label("Justificativa da Prioridade"),complexity_justification:Y().nullable().label("Justificativa da Complexidade"),status:Ze().required().label("Status")}),initialValues:{segment:n.task.segment,task_type:n.task.task_type,task_code:n.task.task_code,name:n.task.name,description:n.task.description,owner_id:n.task.owner_id,responsible_id:n.task.responsible_id,task_status_id:n.task.task_status_id,system_screen:n.task.system_screen,sequence:n.task.sequence,observation:n.task.observation,priority_id:n.task.priority_id,complexity_id:n.task.complexity_id,priority_justification:n.task.priority_justification,complexity_justification:n.task.complexity_justification,finish_date:n.task.finish_date?n.task.finish_date.split("T")[0]:null,expected_date:n.task.expected_date?n.task.expected_date.split("T")[0]:null,created_at:n.task.created_at?n.task.created_at.split("T")[0]:null,status:n.task.status}}),U={complexityRef:r(null),complexityJustificationRef:r(null),responsibleRef:r(null)},z=()=>{b.responsible_id?Re(()=>{U.responsibleRef.value.focus(),U.responsibleRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})}):b.complexity_id?Re(()=>{U.complexityRef.value.focus(),U.complexityRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})}):b.complexity_justification&&Re(()=>{U.complexityJustificationRef.value.focus(),U.complexityJustificationRef.value.$el.scrollIntoView({behavior:"smooth",block:"center"})})};me(b,H=>{console.log(b),z()});const M=D(async H=>{Ie.value||(alert("vai deletar"),delete H.priority_justification),_e.value||(H.expected_date=null),be.value||(H.finish_date=null),console.log("Payload being sent to the backend:",H),await c.updateTask(n.task.id,H),I("edit")}),C=r(""),{value:N}=y("segment"),{value:J}=y("priority_id"),{value:B}=y("complexity_id"),{value:G}=y("name"),{value:T}=y("task_code"),{value:g}=y("task_type"),{value:j}=y("description"),{value:x}=y("owner_id"),{value:E}=y("responsible_id"),{value:p}=y("task_status_id"),{value:u}=y("system_screen"),{value:t}=y("sequence"),{value:s}=y("observation"),{value:ae}=y("priority_justification"),{value:ke}=y("complexity_justification"),{value:_e}=y("expected_date"),{value:be}=y("finish_date"),{value:we}=y("created_at"),{value:ye}=y("status"),Ie=Q(()=>{const H=c.priori.find(m=>m.id===J.value);return H&&H.justify});return me(J,H=>{Ie.value?h("priority_justification",ae.value||""):(ae.value="",$({priority_justification:void 0}))}),(H,m)=>(_(),F("div",null,[C.value?(_(),W(tl,{key:0,color:"error",class:"mb-2"},{default:l(()=>[S(L(C.value),1)]),_:1})):le("",!0),e(Be,{onSubmit:Je(a(M),["prevent"])},{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(N),"onUpdate:modelValue":m[0]||(m[0]=f=>w(N)?N.value=f:null),"error-messages":a(b).segment,items:X,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(g),"onUpdate:modelValue":m[1]||(m[1]=f=>w(g)?g.value=f:null),"error-messages":a(b).task_type,items:P,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(T),"onUpdate:modelValue":m[2]||(m[2]=f=>w(T)?T.value=f:null),"error-messages":a(b).task_code,label:"Número do chamado",variant:"outlined",color:"primary",disabled:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(G),"onUpdate:modelValue":m[3]||(m[3]=f=>w(G)?G.value=f:null),"error-messages":a(b).name,label:"Título",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(u),"onUpdate:modelValue":m[4]||(m[4]=f=>w(u)?u.value=f:null),"error-messages":a(b).system_screen,label:"Tela",variant:"outlined",color:"primary",maxlength:"60",counter:""},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(t),"onUpdate:modelValue":m[5]||(m[5]=f=>w(t)?t.value=f:null),"error-messages":a(b).sequence,label:"Sequência",variant:"outlined",color:"primary",maxlength:"10",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(te,{modelValue:a(j),"onUpdate:modelValue":m[6]||(m[6]=f=>w(j)?j.value=f:null),"error-messages":a(b).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(x),"onUpdate:modelValue":m[7]||(m[7]=f=>w(x)?x.value=f:null),"error-messages":a(b).owner_id,items:a(c).users,label:"Solicitante","item-title":"first_name","item-value":"id",disabled:""},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(we),"onUpdate:modelValue":m[8]||(m[8]=f=>w(we)?we.value=f:null),"error-messages":a(b).created_at,label:"Data de Criação",variant:"outlined",type:"date",disabled:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(p),"onUpdate:modelValue":m[9]||(m[9]=f=>w(p)?p.value=f:null),"error-messages":a(b).task_status_id,items:a(c).taskStatus,label:"Status do Chamado","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(E),"onUpdate:modelValue":m[10]||(m[10]=f=>w(E)?E.value=f:null),"error-messages":a(b).responsible_id,items:a(c).users,label:"Responsável","item-title":"first_name","item-value":"id",ref:"responsibleRef"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(te,{modelValue:a(s),"onUpdate:modelValue":m[11]||(m[11]=f=>w(s)?s.value=f:null),"error-messages":a(b).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(_e),"onUpdate:modelValue":m[12]||(m[12]=f=>w(_e)?_e.value=f:null),"error-messages":a(b).expected_date,label:"Data Esperada",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:a(be),"onUpdate:modelValue":m[13]||(m[13]=f=>w(be)?be.value=f:null),"error-messages":a(b).finish_date,label:"Data de Conclusão",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(J),"onUpdate:modelValue":m[14]||(m[14]=f=>w(J)?J.value=f:null),"error-messages":a(b).priority_id,items:a(c).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(te,{modelValue:a(ae),"onUpdate:modelValue":m[15]||(m[15]=f=>w(ae)?ae.value=f:null),"error-messages":a(b).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:a(B),"onUpdate:modelValue":m[16]||(m[16]=f=>w(B)?B.value=f:null),"error-messages":a(b).complexity_id,items:a(c).complexity,label:"Complexidade do Chamado","item-title":"name","item-value":"id",ref:"complexityRef"},null,8,["modelValue","error-messages","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(te,{modelValue:a(ke),"onUpdate:modelValue":m[17]||(m[17]=f=>w(ke)?ke.value=f:null),"error-messages":a(b).complexity_justification,label:"Justificativa da Complexidade",variant:"outlined",color:"primary",rows:"5",ref:"complexityJustificationRef",maxlength:"500",counter:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(ol,{modelValue:a(ye),"onUpdate:modelValue":m[18]||(m[18]=f=>w(ye)?ye.value=f:null),label:a(ye)?"Ativo":"Inativo",color:"primary",inset:""},null,8,["modelValue","label"])]),_:1})]),_:1}),e(V,{justify:"end"},{default:l(()=>[e(i,{cols:"12",md:"auto"},{default:l(()=>[e(q,{flat:"",text:"Cancelar",onClick:m[19]||(m[19]=f=>I("cancel"))})]),_:1}),e(i,{cols:"12",md:"auto"},{default:l(()=>[e(q,{type:"submit",color:"primary",flat:"",loading:a(O),text:"Editar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},Ct={props:{task:{type:Object,required:!0}},emits:["cancel"],setup(A,{emit:I}){const n=A,c=xe(),X=[{label:"Grãos",value:1},{label:"Proteína",value:2}],P=[{label:"Algo que funcionava, parou de funcionar!",value:1},{label:"Fazer uma solicitação, algo novo (melhoria)!",value:2}],D=r(n.task.segment),b=r(n.task.task_type),O=r(n.task.task_code),h=r(n.task.name),$=r(n.task.description),U=r(n.task.owner_id),z=r(n.task.responsible_id),M=r(n.task.task_status_id),C=r(n.task.system_screen),N=r(n.task.sequence),J=r(n.task.observation),B=r(n.task.priority_id),G=r(n.task.complexity_id),T=r(n.task.priority_justification),g=r(n.task.complexity_justification),j=r(n.task.finish_date?n.task.finish_date.split("T")[0]:null),x=r(n.task.expected_date?n.task.expected_date.split("T")[0]:null),E=r(n.task.created_at?n.task.created_at.split("T")[0]:null),p=r(n.task.status);return(u,t)=>(_(),F("div",null,[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:D.value,"onUpdate:modelValue":t[0]||(t[0]=s=>D.value=s),items:X,label:"Segmento","item-title":"label","item-value":"value",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=s=>b.value=s),items:P,label:"Tipo de chamado","item-title":"label","item-value":"value",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:O.value,"onUpdate:modelValue":t[2]||(t[2]=s=>O.value=s),label:"Número do chamado",variant:"outlined",color:"primary",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),label:"Título",variant:"outlined",color:"primary",readonly:"",class:"custom-label",rows:"2",maxlength:"60"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:C.value,"onUpdate:modelValue":t[4]||(t[4]=s=>C.value=s),label:"Tela",variant:"outlined",color:"primary",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:N.value,"onUpdate:modelValue":t[5]||(t[5]=s=>N.value=s),label:"Sequência",variant:"outlined",color:"primary",maxlength:"10",counter:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(te,{modelValue:$.value,"onUpdate:modelValue":t[6]||(t[6]=s=>$.value=s),label:"Descrição",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"150",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:U.value,"onUpdate:modelValue":t[7]||(t[7]=s=>U.value=s),items:a(c).users,label:"Solicitante","item-title":"first_name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:E.value,"onUpdate:modelValue":t[8]||(t[8]=s=>E.value=s),label:"Data de Criação",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:M.value,"onUpdate:modelValue":t[9]||(t[9]=s=>M.value=s),items:a(c).taskStatus,label:"Status do Chamado","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:z.value,"onUpdate:modelValue":t[10]||(t[10]=s=>z.value=s),items:a(c).users,label:"Responsável","item-title":"first_name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(te,{modelValue:J.value,"onUpdate:modelValue":t[11]||(t[11]=s=>J.value=s),label:"Observação",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:x.value,"onUpdate:modelValue":t[12]||(t[12]=s=>x.value=s),label:"Data Esperada",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(K,{modelValue:j.value,"onUpdate:modelValue":t[13]||(t[13]=s=>j.value=s),label:"Data de Conclusão",variant:"outlined",type:"date",disabled:"",class:"custom-label"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:B.value,"onUpdate:modelValue":t[14]||(t[14]=s=>B.value=s),items:a(c).priori,label:"Prioridade","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(te,{modelValue:T.value,"onUpdate:modelValue":t[15]||(t[15]=s=>T.value=s),label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"6"},{default:l(()=>[e(R,{modelValue:G.value,"onUpdate:modelValue":t[16]||(t[16]=s=>G.value=s),items:a(c).complexity,label:"Complexidade do Chamado","item-title":"name","item-value":"id",disabled:"",class:"custom-label"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"6"},{default:l(()=>[e(te,{modelValue:g.value,"onUpdate:modelValue":t[17]||(t[17]=s=>g.value=s),label:"Justificativa da Complexidade",variant:"outlined",color:"primary",rows:"5",readonly:"",class:"custom-label",maxlength:"500",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(ol,{modelValue:p.value,"onUpdate:modelValue":t[18]||(t[18]=s=>p.value=s),label:p.value?"Ativo":"Inativo",color:"primary",inset:"",disabled:""},null,8,["modelValue","label"])]),_:1})]),_:1}),e(V,{justify:"end"},{default:l(()=>[e(i,{cols:"12",md:"auto"},{default:l(()=>[e(q,{flat:"",text:"Fechar",onClick:t[19]||(t[19]=s=>u.$emit("cancel"))})]),_:1})]),_:1})]),_:1})]))}},nl=xl("chats",{state:()=>({messages:[]}),actions:{async fetchMessages(A){try{const I=await Ne.get(`/api/interactions/${A}`);this.messages=I.data}catch(I){console.error("Error fetching messages:",I)}},async createInteraction(A,I,n){try{return(await Ne.post("/api/interactions",{task_id:A,comment:I,user_id:n})).data}catch(c){console.error("Error creating interaction:",c)}},async uploadFile(A){try{return(await Ne.post("/api/interaction-file",A,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(I){throw console.error("Error uploading file:",I),I}}}});function ul(A){return`https://syscall-api.devtest.com.br//storage/${A}`}const il=A=>(Xe("data-v-4ff77f2d"),A=A(),Ye(),A),St=il(()=>d("span",{class:"text-h5"},"Notas de Trabalho",-1)),$t={class:"comment-text"},Ut={key:0},Tt=["href"],qt={class:"text-right text-caption mt-2"},At={class:"email-text"},It=S(" - "),Mt={class:"email-text"},jt=S("Adicionar Comentário"),Ft=S("Fechar"),Pt=il(()=>d("span",{class:"text-h5"},"Adicionar Comentário",-1)),Dt=S("Cancelar"),Ot=S("Adicionar"),Rt={props:{taskId:{type:Number,required:!0},showChatModal:{type:Boolean,required:!0},userId:{type:Number,required:!0}},emits:["update:showChatModal"],setup(A,{emit:I}){const n=A,c=nl(),{messages:X}=Te(c),P=r(!1),D=r(!1),b=ze({comment:Y().required().label("Comentário"),files:el().of(ll()).nullable()}),{handleSubmit:O,errors:h,isSubmitting:$,resetForm:U}=Le({validationSchema:b,initialValues:{comment:"",files:[]}}),z=O(async T=>{try{const g=await c.createInteraction(n.taskId,T.comment,n.userId);if(T.files&&T.files.length>0){const j=new FormData;j.append("interaction_id",g.id);for(const x of T.files)j.append("files[]",x);await c.uploadFile(j)}await c.fetchMessages(n.taskId),D.value=!1,I("update:showChatModal",!1)}catch(g){console.error("Erro ao adicionar comentário ou fazer upload dos arquivos:",g)}}),{value:M}=y("comment"),{value:C}=y("files");me(()=>n.showChatModal,async T=>{T?(P.value=!0,await c.fetchMessages(n.taskId)):P.value=!1});const N=()=>{I("update:showChatModal",!1)},J=()=>{U(),D.value=!0},B=T=>{const g={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};return new Date(T).toLocaleDateString("pt-BR",g)},G=Q(()=>[...X.value].sort((T,g)=>g.id-T.id));return(T,g)=>{const j=kl("v-list-item-content");return _(),W(re,{modelValue:P.value,"onUpdate:modelValue":g[4]||(g[4]=x=>P.value=x),"max-width":"800px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[St]),_:1}),e(ue,null,{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[(_(!0),F(qe,null,Pe(a(G),(x,E)=>(_(),W(i,{key:E,cols:"12"},{default:l(()=>[e(se,{class:"mb-3"},{default:l(()=>[e(ue,null,{default:l(()=>[d("div",$t,L(x.comment),1),x.interaction_files&&x.interaction_files.length?(_(),F("div",Ut,[e(he),e(wl,null,{default:l(()=>[(_(!0),F(qe,null,Pe(x.interaction_files,(p,u)=>(_(),W(ge,{key:u},{default:l(()=>[e(j,null,{default:l(()=>[e(Cl,null,{default:l(()=>[d("a",{href:a(ul)(p.path),target:"_blank"},L(p.name),9,Tt)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])):le("",!0),d("div",qt,[d("span",At,L(x.user_email),1),It,d("span",Mt,L(B(x.created_at)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(De,null,{default:l(()=>[e(q,{color:"primary",onClick:J},{default:l(()=>[jt]),_:1}),e(q,{color:"secondary",onClick:N},{default:l(()=>[Ft]),_:1})]),_:1})]),_:1}),e(re,{modelValue:D.value,"onUpdate:modelValue":g[3]||(g[3]=x=>D.value=x),"max-width":"500px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[Pt]),_:1}),e(ue,null,{default:l(()=>[e(Be,{onSubmit:Je(a(z),["prevent"])},{default:l(()=>[e(te,{modelValue:a(M),"onUpdate:modelValue":g[0]||(g[0]=x=>w(M)?M.value=x:null),label:"Comentário","error-messages":a(h).comment},null,8,["modelValue","error-messages"]),e(al,{modelValue:a(C),"onUpdate:modelValue":g[1]||(g[1]=x=>w(C)?C.value=x:null),label:"Selecionar Arquivos","error-messages":a(h).files,"show-size":"",multiple:""},null,8,["modelValue","error-messages"])]),_:1},8,["onSubmit"])]),_:1}),e(De,null,{default:l(()=>[e(q,{color:"blue darken-1",text:"",onClick:g[2]||(g[2]=x=>D.value=!1)},{default:l(()=>[Dt]),_:1}),e(q,{color:"blue darken-1",text:"",loading:a($),onClick:a(z)},{default:l(()=>[Ot]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},Ke=sl(Rt,[["__scopeId","data-v-4ff77f2d"]]),Nt=d("span",{class:"text-h5"},"Anexos do Chamado",-1),Et=["href"],zt=S("Fechar"),Jt={props:{taskId:{type:Number,required:!0},showAttachmentsModal:{type:Boolean,required:!0}},emits:["update:showAttachmentsModal"],setup(A,{emit:I}){const n=A,c=xe(),{taskFiles:X}=Te(c),P=r(!1);me(()=>n.showAttachmentsModal,async O=>{O?(await c.getTaskFiles(n.taskId),P.value=!0):P.value=!1});const D=()=>{I("update:showAttachmentsModal",!1)},b=async O=>{await c.deleteTaskFile(O),await c.getTaskFiles(n.taskId)};return(O,h)=>(_(),W(re,{modelValue:P.value,"onUpdate:modelValue":h[0]||(h[0]=$=>P.value=$),"max-width":"800px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[Nt]),_:1}),e(ue,null,{default:l(()=>[e(Ae,null,{default:l(()=>[e(V,null,{default:l(()=>[(_(!0),F(qe,null,Pe(a(X),($,U)=>(_(),W(i,{key:U,cols:"12"},{default:l(()=>[e(se,{class:"mb-3"},{default:l(()=>[e(ue,null,{default:l(()=>[d("a",{href:a(ul)($.path),target:"_blank"},L($.name),9,Et),e(q,{icon:"",onClick:z=>b($.id)},{default:l(()=>[e(a(bl))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(De,null,{default:l(()=>[e(q,{color:"secondary",onClick:D},{default:l(()=>[zt]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Bt={class:"mb-5 pb-5 border-b border-opacity-100"},Lt=S("Novo Chamado"),Gt=S("Adicionar chamado"),Ht=S("Visualizar chamado"),Qt=S("Editar chamado"),Kt=S("Cancelar"),Wt=S("Deletar"),Xt=d("span",{class:"text-h5"},"Adicionar Nota de Trabalho",-1),Yt=S("Cancelar"),Zt=S("Adicionar"),sa={setup(A){const I=Ee(),n=xe(),{toShow:c,toEdit:X,toDelete:P}=Te(n),D=nl();Te(D);const{isLoading:b}=Ue(n.getTasks());Ue(n.getPriorities()),Ue(n.getComplexities()),Ue(n.getTasksStatus()),Ue(n.getUsers());const O=Q({get(){return!!Object.keys(X.value).length},set(p){p||(X.value={})}}),h=Q({get(){return!!Object.keys(c.value).length},set(p){p||(c.value={})}}),$=Q({get(){return!!Object.keys(P.value).length},set(p){p||(P.value={})}}),U=r(!1);async function z(p){U.value=!0,await n.deleteTask(p.id),P.value={},U.value=!1}const M=r(!1),C=r(0),N=r(!1),J=r(""),B=r(I.user.id),G=p=>{p&&p.id&&(C.value=p.id,M.value=!0)},T=p=>{p&&p.id&&(C.value=p.id,N.value=!0)},g=async()=>{await D.addMessage(C.value,J.value,B.value),J.value="",N.value=!1},j=r(!1),x=p=>{p&&p.id&&(C.value=p.id,j.value=!0)},E=r("");return me(E,p=>{n.getTasks(p)}),(p,u)=>(_(),F("div",null,[d("div",Bt,[e(V,null,{default:l(()=>[e(i,{cols:"12",lg:"4",md:"6"},{default:l(()=>[e(K,{density:"compact",modelValue:E.value,"onUpdate:modelValue":u[0]||(u[0]=t=>E.value=t),label:"Pesquisar Chamados","append-inner-icon":"mdi-magnify","hide-details":"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(i,{class:"text-right"},{default:l(()=>[e(re,{width:"800",persistent:""},{activator:l(({props:t})=>[e(q,de({flat:"",color:"primary"},t),{default:l(()=>[Lt]),_:2},1040)]),default:l(({isActive:t})=>[e(se,{width:"800"},{default:l(()=>[e(pe,null,{default:l(()=>[Gt]),_:1}),e(ue,null,{default:l(()=>[e(kt,{onAdd:s=>t.value=!1,onCancel:s=>t.value=!1},null,8,["onAdd","onCancel"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1})]),_:1})]),a(b)?(_(),W($l,{key:0,width:3,color:"primary",indeterminate:""})):(_(),F(qe,{key:1},[e(xt,{onOpenChat:G,onAddNote:T,onOpenAttachments:x}),e(re,{modelValue:a(h),"onUpdate:modelValue":u[1]||(u[1]=t=>w(h)?h.value=t:null),width:"800",persistent:""},{default:l(({isActive:t})=>[e(se,{width:"800"},{default:l(()=>[e(pe,null,{default:l(()=>[Ht]),_:1}),e(ue,null,{default:l(()=>[e(Ct,{task:a(c),onCancel:s=>t.value=!1,onShow:s=>t.value=!1},null,8,["task","onCancel","onShow"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(re,{modelValue:a(O),"onUpdate:modelValue":u[2]||(u[2]=t=>w(O)?O.value=t:null),width:"800",persistent:""},{default:l(({isActive:t})=>[e(se,{width:"800"},{default:l(()=>[e(pe,null,{default:l(()=>[Qt]),_:1}),e(ue,null,{default:l(()=>[e(wt,{task:a(X),onCancel:s=>t.value=!1,onEdit:s=>t.value=!1},null,8,["task","onCancel","onEdit"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(re,{modelValue:a($),"onUpdate:modelValue":u[4]||(u[4]=t=>w($)?$.value=t:null),width:"800",persistent:""},{default:l(({isActive:t})=>[e(se,{"prepend-icon":a(We),title:"Você tem certeza que deseja deletar este chamado?"},{actions:l(()=>[e(Sl),e(q,{onClick:s=>t.value=!1},{default:l(()=>[Kt]),_:2},1032,["onClick"]),e(q,{onClick:u[3]||(u[3]=s=>z(a(P))),variant:"tonal",color:"error",loading:U.value},{default:l(()=>[Wt]),_:1},8,["loading"])]),_:2},1032,["prepend-icon"])]),_:1},8,["modelValue"])],64)),e(Ke,{taskId:C.value,showChatModal:M.value,userId:B.value,"onUpdate:showChatModal":u[5]||(u[5]=t=>M.value=t)},null,8,["taskId","showChatModal","userId"]),e(re,{modelValue:N.value,"onUpdate:modelValue":u[8]||(u[8]=t=>N.value=t),"max-width":"500px",persistent:""},{default:l(()=>[e(se,null,{default:l(()=>[e(pe,null,{default:l(()=>[Xt]),_:1}),e(ue,null,{default:l(()=>[e(Ke,{taskId:C.value,showChatModal:M.value,userId:B.value,"onUpdate:showChatModal":u[6]||(u[6]=t=>M.value=t)},null,8,["taskId","showChatModal","userId"])]),_:1}),e(De,null,{default:l(()=>[e(q,{color:"blue darken-1",text:"",onClick:u[7]||(u[7]=t=>N.value=!1)},{default:l(()=>[Yt]),_:1}),e(q,{color:"blue darken-1",text:"",onClick:g},{default:l(()=>[Zt]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Jt,{taskId:C.value,showAttachmentsModal:j.value,"onUpdate:showAttachmentsModal":u[9]||(u[9]=t=>j.value=t)},null,8,["taskId","showAttachmentsModal"])]))}};export{sa as default};
