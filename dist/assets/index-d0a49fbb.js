import{i as K,j as M}from"./vue-tabler-icons.es-e8343748.js";import{ad as Q,ae as k,ac as U,o as d,e as y,w as t,a as u,c as g,F as x,q as F,y as r,d as v,t as C,i as j,l as T,b as e,z,V as h,p as N,af as Y,ag as O,ah as P,J as $,ai as R,aj as L,ak as J,W,al as X,C as Z,am as ee,B as A,a0 as B,an as S,a8 as E,aa as q,ao as I,a7 as te,X as ae,ap as le}from"./index-fc9b34ed.js";import{u as G,a as H}from"./vee-validate.esm-a02ea01b.js";const w=Q("teams",{state:()=>({teams:[],toEdit:{},toDelete:{}}),actions:{async getTeams(){this.teams=await k.get("api/teams").then(i=>i.data.data)},async storeTeam(i){const s=await k.post("api/teams",i).then(l=>l.data.data);this.teams.push(s)},async updateTeam(i,s){const l=await k.put(`api/teams/${i}`,s).then(_=>_.data.data),p=this.teams.findIndex(_=>_.token===i);this.teams.splice(p,1,l)},async deleteTeam(i){await k.delete(`api/teams/${i}`).then(l=>l.data.data);const s=this.teams.findIndex(l=>l.token===i);this.teams.splice(s,1)}}}),se=u("thead",null,[u("tr",null,[u("th",{class:"text-left"}," Time "),u("th",{class:"text-left"}," Cargo "),u("th",{class:"text-left"}," Ações "),u("th")])],-1),ne={class:"text-right"},oe={key:0,class:"d-flex align-center"},re={__name:"TeamsTable",setup(i){const s=w(),{teams:l,toEdit:p,toDelete:_}=U(s);return(V,b)=>(d(),y(Y,{class:"border-opacity-100"},{default:t(()=>[se,u("tbody",null,[(d(!0),g(x,null,F(r(l),n=>(d(),g("tr",{key:n.name},[u("td",null,[v(C(n.name)+" ",1),n.default?(d(),y(j,{key:0,size:"small",variant:"tonal",color:"primary",class:"ml-2"},{default:t(()=>[v(" Default ")]),_:1})):T("",!0)]),u("td",null,[(d(!0),g(x,null,F(n.roles,m=>(d(),y(j,{key:`${n.token}_${m.name}`,size:"small",variant:"tonal"},{default:t(()=>[v(C(m.name),1)]),_:2},1024))),128))]),u("td",ne,[n.is_admin?(d(),g("div",oe,[e(z,{text:"Edit"},{activator:t(({props:m})=>[e(h,N({icon:"",flat:"",onClick:o=>p.value=n},m),{default:t(()=>[e(r(K),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),e(z,{text:"Delete"},{activator:t(({props:m})=>[e(h,N({icon:"",flat:"",onClick:o=>_.value=n},m),{default:t(()=>[e(r(M),{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1024)])):T("",!0)])]))),128))])]),_:1}))}},ie={class:"text-right"},de={__name:"TeamAddForm",emits:["cancel","add"],setup(i,{emit:s}){const l=w(),p=O({name:P().required().label("Nome")}),{handleSubmit:_,errors:V,isSubmitting:b}=G({validationSchema:p,initialValues:{name:""}}),n=_(async c=>{await l.storeTeam(c),s("add")}),m=$(""),{value:o}=H("name");return(c,a)=>(d(),g(x,null,[m.value?(d(),y(R,{key:0,color:"error",class:"mb-2"},{default:t(()=>[v(C(m.value),1)]),_:1})):T("",!0),e(X,{onSubmit:W(r(n),["prevent"])},{default:t(()=>[e(L,{modelValue:r(o),"onUpdate:modelValue":a[0]||(a[0]=f=>J(o)?o.value=f:null),"error-messages":r(V).name,label:"Nome",variant:"outlined",color:"primary"},null,8,["modelValue","error-messages"]),u("div",ie,[e(h,{flat:"",text:"Cancelar",onClick:a[1]||(a[1]=f=>s("cancel"))}),e(h,{type:"submit",color:"primary",flat:"",loading:r(b),text:"Adicionar"},null,8,["loading"])])]),_:1},8,["onSubmit"])],64))}},ue={class:"text-right"},me={__name:"TeamEditForm",props:{team:{type:Object,required:!0}},emits:["cancel","edit"],setup(i,{emit:s}){const l=i,p=w(),_=O({name:P().required().label("Nome")}),{handleSubmit:V,errors:b,isSubmitting:n}=G({validationSchema:_,initialValues:{name:l.team.name}}),m=V(async a=>{await p.updateTeam(l.team.token,a),s("edit")}),o=$(""),{value:c}=H("name");return(a,f)=>(d(),g(x,null,[o.value?(d(),y(R,{key:0,color:"error",class:"mb-2"},{default:t(()=>[v(C(o.value),1)]),_:1})):T("",!0),e(X,{onSubmit:W(r(m),["prevent"])},{default:t(()=>[e(L,{modelValue:r(c),"onUpdate:modelValue":f[0]||(f[0]=D=>J(c)?c.value=D:null),"error-messages":r(b).name,label:"Nome",variant:"outlined",color:"primary"},null,8,["modelValue","error-messages"]),u("div",ue,[e(h,{flat:"",text:"Cancelar",onClick:f[1]||(f[1]=D=>s("cancel"))}),e(h,{type:"submit",color:"primary",flat:"",loading:r(n),text:"Editar"},null,8,["loading"])])]),_:1},8,["onSubmit"])],64))}},ce={class:"mb-5 pb-5 border-b border-opacity-100"},fe=u("h1",{class:"text-h3"},"Meus times",-1),he=Z({__name:"index",setup(i){const s=w(),{toEdit:l,toDelete:p}=U(s),{isLoading:_}=ee(s.getTeams()),V=A({get(){return!!Object.keys(l.value).length},set(o){o||(l.value={})}}),b=A({get(){return!!Object.keys(p.value).length},set(o){o||(p.value={})}}),n=$(!1);async function m(o){n.value=!0,await s.deleteTeam(o.token),p.value={},n.value=!1}return $([{text:"2 New Team",disabled:!0,href:"#"}]),(o,c)=>(d(),g("div",null,[u("div",ce,[e(te,null,{default:t(()=>[e(B,null,{default:t(()=>[fe]),_:1}),e(B,{class:"text-right"},{default:t(()=>[e(S,{width:"auto"},{activator:t(({props:a})=>[e(h,N({flat:"",color:"primary"},a),{default:t(()=>[v("Novo time ")]),_:2},1040)]),default:t(({isActive:a})=>[e(E,{width:"400"},{default:t(()=>[e(q,null,{default:t(()=>[v("Adicionar time")]),_:1}),e(I,null,{default:t(()=>[e(de,{onAdd:f=>a.value=!1,onCancel:f=>a.value=!1},null,8,["onAdd","onCancel"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1})]),_:1})]),r(_)?(d(),y(le,{key:0,width:3,color:"primary",indeterminate:""})):(d(),g(x,{key:1},[e(re),e(S,{modelValue:V.value,"onUpdate:modelValue":c[0]||(c[0]=a=>V.value=a),width:"auto"},{default:t(({isActive:a})=>[e(E,{width:"400"},{default:t(()=>[e(q,null,{default:t(()=>[v("Editar time")]),_:1}),e(I,null,{default:t(()=>[e(me,{team:r(l),onCancel:f=>a.value=!1,onEdit:f=>a.value=!1},null,8,["team","onCancel","onEdit"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(S,{modelValue:b.value,"onUpdate:modelValue":c[2]||(c[2]=a=>b.value=a),width:"auto"},{default:t(({isActive:a})=>[e(E,{"prepend-icon":r(M),title:"Você tem certeza que deseja deletar este time?"},{actions:t(()=>[e(ae),e(h,{onClick:f=>a.value=!1},{default:t(()=>[v(" Cancelar ")]),_:2},1032,["onClick"]),e(h,{onClick:c[1]||(c[1]=f=>m(r(p))),variant:"tonal",color:"error",loading:n.value},{default:t(()=>[v(" Deletar ")]),_:1},8,["loading"])]),_:2},1032,["prepend-icon"])]),_:1},8,["modelValue"])],64))]))}});export{he as default};
