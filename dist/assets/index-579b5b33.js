import{P as Ie,i as Se,N as Pe}from"./vue-tabler-icons.es-ddf9d496.js";import{a3 as Te,a4 as R,a5 as ue,o as S,e as G,w as a,a as u,c as H,q as _e,t as O,d as j,i as De,l as ie,b as e,V as T,M as he,N as xe,p as Z,an as Ce,A as te,z as t,F as me,a6 as Ae,v as $e,C as X,ao as Ne,a7 as be,ap as z,a8 as E,ak as Ue,L,Q as se,a9 as je,a0 as ge,ai as b,_ as d,aq as B,ab as _,aa as K,ar as W,S as qe,ac as ye,as as fe,al as Ee,at as Fe,au as Oe,r as ze,ag as oe,ah as ae,af as Y,I as Je,G as Re,m as Be,j as Le,av as ve,aw as Ge,ae as ee,ad as le,T as He,aj as Qe}from"./index-b2362ac7.js";import{a as r,u as ke}from"./vee-validate.esm-90dfbd51.js";const ce=Te("tasks",{state:()=>({tasks:[],priori:[],complexity:[],users:[],taskStatus:[],toEdit:{},toDelete:{},toShowChat:{},toAddChat:{}}),actions:{async getTasks(){this.tasks=await R.get("api/tasks").then(m=>m.data.data)},async getPriorities(){this.priori=await R.get("api/priorities").then(m=>m.data.data)},async getComplexities(){this.complexity=await R.get("api/complexities").then(m=>m.data.data)},async getUsers(){this.users=await R.get("api/users").then(m=>m.data.data)},async getTasksStatus(){this.taskStatus=await R.get("api/tasks-status").then(m=>m.data.data)},async storeTask(m){console.log("valor do payload na storeTask",m);const v=await R.post("api/tasks",m).then(l=>l.data.data);this.tasks.push(v),this.getTasks()},async updateTask(m,v){const l=await R.put(`api/tasks/${m}`,v).then(U=>U.data.data),p=this.tasks.findIndex(U=>U.id===m);this.tasks.splice(p,1,l),this.getTasks()},async deleteTask(m){await R.delete(`api/tasks/${m}`).then(l=>l.data.data);const v=this.tasks.findIndex(l=>l.id===m);this.tasks.splice(v,1)}}}),Ke=u("thead",null,[u("tr",null,[u("th",{class:"text-left"},"Número do chamado"),u("th",{class:"text-left"},"Título"),u("th",{class:"text-left"},"Descrição"),u("th",{class:"text-left"},"Solicitante"),u("th",{class:"text-left"},"Responsável"),u("th",{class:"text-left"},"Status"),u("th",{class:"text-left"},"Prioridade"),u("th",{class:"text-left"},"Complexidade"),u("th",{class:"text-left"},"Ações"),u("th")])],-1),We=j(" Default "),Xe={class:"text-right"},Ye={class:"d-flex align-center"},Ze={class:"text-right"},ea={class:"d-flex align-center"},aa={class:"text-right"},ta={class:"d-flex align-center"},la={setup(m){const v=ce(),{tasks:l,toEdit:p,toDelete:U}=ue(v);return($,q)=>(S(),G(Ae,{class:"border-opacity-100"},{default:a(()=>[Ke,u("tbody",null,[(S(!0),H(me,null,_e(t(l),(o,F)=>{var k;return S(),H("tr",{key:F},[u("td",null,O(o.task_code),1),u("td",null,[j(O(o.name)+" ",1),o.default?(S(),G(De,{key:0,size:"small",variant:"tonal",color:"primary",class:"ml-2"},{default:a(()=>[We]),_:1})):ie("",!0)]),u("td",null,O(o.description),1),u("td",null,O(o.user_owner.first_name),1),u("td",null,O(((k=o.user_responsible)==null?void 0:k.first_name)||"Nenhum responsável"),1),u("td",null,O(o.task_status.name),1),u("td",Xe,[u("div",Ye,[e(te,{text:o.priority_justification},{activator:a(({props:h})=>[e(T,he(xe(h)),{default:a(()=>[u("span",Z($.attrs,Ce($.on)),O(o.priority.name),17)]),_:2},1040)]),_:2},1032,["text"])])]),u("td",Ze,[u("div",ea,[e(te,{text:o.complexity_justification||"Aguardando análise"},{activator:a(({props:h})=>[e(T,he(xe(h)),{default:a(()=>{var x;return[u("span",Z($.attrs,Ce($.on)),O(((x=o.complexity)==null?void 0:x.name)||"Aguardando análise"),17)]}),_:2},1040)]),_:2},1032,["text"])])]),u("td",aa,[u("div",ta,[e(te,{text:"Editar Chamado"},{activator:a(({props:h})=>[e(T,Z({icon:"",flat:"",onClick:x=>p.value=o},h),{default:a(()=>[e(t(Ie),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024),e(te,{text:"Deletar Chamado"},{activator:a(({props:h})=>[e(T,Z({icon:"",flat:"",onClick:x=>U.value=o},h),{default:a(()=>[e(t(Se),{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1024),e(te,{text:"Consultar Notas de Trabalho"},{activator:a(({props:h})=>[e(T,Z({icon:"",flat:"",onClick:x=>$.$emit("openChat",o)},h),{default:a(()=>[e(t(Pe),{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1024)])])])}),128))])]),_:1}))}},sa={emits:["cancel","add"],setup(m,{emit:v}){const l=$e(),p=ce(),U=[{label:"Grãos",value:1},{label:"Proteína",value:2}],$=[{label:"É uma melhoria ?",value:1},{label:"É algo novo ?",value:2}],q=X(()=>{var V;return((V=p.priori.find(f=>f.is_default))==null?void 0:V.id)||null}),o=X(()=>{var V;return((V=p.taskStatus.find(f=>f.is_default))==null?void 0:V.id)||null}),{value:F}=r("segment",2),{value:k}=r("priority_id"),{value:h}=r("task_status_id");Ne(()=>{q.value&&!k.value&&(k.value=q.value),o.value&&!h.value&&(h.value=o.value)});const x=X(()=>{const V=p.priori.find(f=>f.id===k.value);return V&&V.justify}),A=X(()=>be({segment:z().required().label("Segmento"),task_type:z().required().label("Tipo de chamado"),name:E().required().label("Título"),system_screen:E().required().label("Tela"),description:E().required().label("Descrição"),owner_id:z().required().label("Solicitante"),task_status_id:z().required().label("Status do Chamado"),priority_id:z().required().label("Prioridade"),observation:E().nullable().label("Observação"),priority_justification:x.value?E().required().label("Justificativa da Prioridade"):E().label("Justificativa da Prioridade"),status:Ue().required().label("Status")})),{handleSubmit:M,errors:w,isSubmitting:J}=ke({validationSchema:A,initialValues:{segment:1,task_type:"",name:"",system_screen:"",description:"",owner_id:l.user.id,responsible_id:"",task_status_id:o.value,priority_id:q.value,observation:"",created_at:"",expected_date:"",finish_date:"",priority_justification:"",status:!0}}),I=M(async V=>{await p.storeTask(V),v("add")}),y=L(""),{value:P}=r("name"),{value:n}=r("task_type"),{value:g}=r("system_screen"),{value:c}=r("description");r("owner_id"),r("responsible_id");const{value:D}=r("observation");r("created_at"),r("expected_date"),r("finish_date");const{value:Q}=r("priority_justification");return r("status"),se(q,V=>{V&&!k.value&&(k.value=V)}),se(o,V=>{V&&!h.value&&(h.value=V)}),se(k,()=>{x.value||(Q.value="")}),(V,f)=>(S(),H("div",null,[y.value?(S(),G(je,{key:0,color:"error",class:"mb-2"},{default:a(()=>[j(O(y.value),1)]),_:1})):ie("",!0),e(ye,{onSubmit:qe(t(I),["prevent"])},{default:a(()=>[e(ge,null,{default:a(()=>[e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(B,{modelValue:t(F),"onUpdate:modelValue":f[0]||(f[0]=C=>_(F)?F.value=C:null),"error-messages":t(w).segment,items:U,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(B,{modelValue:t(n),"onUpdate:modelValue":f[1]||(f[1]=C=>_(n)?n.value=C:null),"error-messages":t(w).task_type,items:$,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(K,{modelValue:t(P),"onUpdate:modelValue":f[2]||(f[2]=C=>_(P)?P.value=C:null),"error-messages":t(w).name,label:"Título",variant:"outlined",color:"primary"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(K,{modelValue:t(g),"onUpdate:modelValue":f[3]||(f[3]=C=>_(g)?g.value=C:null),"error-messages":t(w).system_screen,label:"Tela",variant:"outlined",color:"primary"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(c),"onUpdate:modelValue":f[4]||(f[4]=C=>_(c)?c.value=C:null),"error-messages":t(w).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(D),"onUpdate:modelValue":f[5]||(f[5]=C=>_(D)?D.value=C:null),"error-messages":t(w).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12",md:"12"},{default:a(()=>[e(B,{modelValue:t(k),"onUpdate:modelValue":f[6]||(f[6]=C=>_(k)?k.value=C:null),"error-messages":t(w).priority_id,items:t(p).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),t(x)?(S(),G(b,{key:0},{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(Q),"onUpdate:modelValue":f[7]||(f[7]=C=>_(Q)?Q.value=C:null),"error-messages":t(w).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})):ie("",!0),e(b,{justify:"end"},{default:a(()=>[e(d,{cols:"12",md:"auto"},{default:a(()=>[e(T,{flat:"",text:"Cancelar",onClick:f[8]||(f[8]=C=>v("cancel"))})]),_:1}),e(d,{cols:"12",md:"auto"},{default:a(()=>[e(T,{type:"submit",color:"primary",flat:"",loading:t(J),text:"Adicionar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},oa={props:{task:{type:Object,required:!0}},emits:["cancel","edit"],setup(m,{emit:v}){const l=m,p=ce(),U=[{label:"Grãos",value:1},{label:"Proteína",value:2}],$=[{label:"É uma melhoria ?",value:1},{label:"É algo novo ?",value:2}],{handleSubmit:q,errors:o,isSubmitting:F,setFieldValue:k,setErrors:h}=ke({validationSchema:be({segment:z().required().label("Segmento"),task_type:z().required().label("Tipo de chamado"),task_code:E().required().label("Número do chamado"),name:E().required().label("Título"),system_screen:E().required().label("Tela"),description:E().required().label("Descrição"),owner_id:z().required().label("Solicitante"),responsible_id:z().required().label("Responsável"),task_status_id:z().required().label("Status do Chamado"),priority_id:z().required().label("Prioridade do Chamado"),complexity_id:z().required().label("Complexidade do Chamado"),observation:E().nullable().label("Observação"),created_at:fe().nullable().label("Data de Criação"),expected_date:fe().nullable().label("Data de Criação").transform((N,s)=>s===""?null:N),finish_date:fe().nullable().label("Data de Conclusão").transform((N,s)=>s===""?null:N),priority_justification:E().nullable().label("Justificativa da Prioridade"),complexity_justification:E().nullable().label("Justificativa da Complexidade"),status:Ue().required().label("Status")}),initialValues:{segment:l.task.segment,task_type:l.task.task_type,task_code:l.task.task_code,name:l.task.name,description:l.task.description,owner_id:l.task.owner_id,responsible_id:l.task.responsible_id,task_status_id:l.task.task_status_id,system_screen:l.task.system_screen,observation:l.task.observation,priority_id:l.task.priority_id,complexity_id:l.task.complexity_id,priority_justification:l.task.priority_justification,complexity_justification:l.task.complexity_justification,finish_date:l.task.finish_date?l.task.finish_date.split("T")[0]:null,expected_date:l.task.expected_date?l.task.expected_date.split("T")[0]:null,created_at:l.task.created_at?l.task.created_at.split("T")[0]:null,status:l.task.status}}),x=q(async N=>{Ve.value||delete N.priority_justification,re.value||(N.expected_date=null),ne.value||(N.finish_date=null),console.log("Payload being sent to the backend:",N),await p.updateTask(l.task.id,N),v("edit")}),A=L(""),{value:M}=r("segment"),{value:w}=r("priority_id"),{value:J}=r("complexity_id"),{value:I}=r("name"),{value:y}=r("task_code"),{value:P}=r("task_type"),{value:n}=r("description"),{value:g}=r("owner_id"),{value:c}=r("responsible_id"),{value:D}=r("task_status_id"),{value:Q}=r("system_screen"),{value:V}=r("observation"),{value:f}=r("priority_justification"),{value:C}=r("complexity_justification"),{value:re}=r("expected_date"),{value:ne}=r("finish_date"),{value:pe}=r("created_at"),{value:de}=r("status"),Ve=X(()=>{const N=p.priori.find(s=>s.id===w.value);return N&&N.is_justify});return se(w,N=>{Ve.value?k("priority_justification",f.value||""):(f.value="",h({priority_justification:void 0}))}),(N,s)=>(S(),H("div",null,[A.value?(S(),G(je,{key:0,color:"error",class:"mb-2"},{default:a(()=>[j(O(A.value),1)]),_:1})):ie("",!0),e(ye,{onSubmit:qe(t(x),["prevent"])},{default:a(()=>[e(ge,null,{default:a(()=>[e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(B,{modelValue:t(M),"onUpdate:modelValue":s[0]||(s[0]=i=>_(M)?M.value=i:null),"error-messages":t(o).segment,items:U,label:"Segmento","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(B,{modelValue:t(P),"onUpdate:modelValue":s[1]||(s[1]=i=>_(P)?P.value=i:null),"error-messages":t(o).task_type,items:$,label:"Tipo de chamado","item-title":"label","item-value":"value"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(K,{modelValue:t(y),"onUpdate:modelValue":s[2]||(s[2]=i=>_(y)?y.value=i:null),"error-messages":t(o).task_code,label:"Número do chamado",variant:"outlined",color:"primary",disabled:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(K,{modelValue:t(I),"onUpdate:modelValue":s[3]||(s[3]=i=>_(I)?I.value=i:null),"error-messages":t(o).name,label:"Título",variant:"outlined",color:"primary"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(K,{modelValue:t(Q),"onUpdate:modelValue":s[4]||(s[4]=i=>_(Q)?Q.value=i:null),"error-messages":t(o).system_screen,label:"Tela",variant:"outlined",color:"primary"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(n),"onUpdate:modelValue":s[5]||(s[5]=i=>_(n)?n.value=i:null),"error-messages":t(o).description,label:"Descrição",variant:"outlined",color:"primary",rows:"5"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:t(g),"onUpdate:modelValue":s[6]||(s[6]=i=>_(g)?g.value=i:null),"error-messages":t(o).owner_id,items:t(p).users,label:"Solicitante","item-title":"first_name","item-value":"id",disabled:""},null,8,["modelValue","error-messages","items"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(K,{modelValue:t(pe),"onUpdate:modelValue":s[7]||(s[7]=i=>_(pe)?pe.value=i:null),"error-messages":t(o).created_at,label:"Data de Criação",variant:"outlined",type:"date",disabled:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:t(D),"onUpdate:modelValue":s[8]||(s[8]=i=>_(D)?D.value=i:null),"error-messages":t(o).task_status_id,items:t(p).taskStatus,label:"Status do Chamado","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(B,{modelValue:t(c),"onUpdate:modelValue":s[9]||(s[9]=i=>_(c)?c.value=i:null),"error-messages":t(o).responsible_id,items:t(p).users,label:"Responsável","item-title":"first_name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(V),"onUpdate:modelValue":s[10]||(s[10]=i=>_(V)?V.value=i:null),"error-messages":t(o).observation,label:"Observação",variant:"outlined",color:"primary",rows:"5"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12",md:"6"},{default:a(()=>[e(K,{modelValue:t(re),"onUpdate:modelValue":s[11]||(s[11]=i=>_(re)?re.value=i:null),"error-messages":t(o).expected_date,label:"Data Esperada",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(K,{modelValue:t(ne),"onUpdate:modelValue":s[12]||(s[12]=i=>_(ne)?ne.value=i:null),"error-messages":t(o).finish_date,label:"Data de Conclusão",variant:"outlined",type:"date"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12",md:"12"},{default:a(()=>[e(B,{modelValue:t(w),"onUpdate:modelValue":s[13]||(s[13]=i=>_(w)?w.value=i:null),"error-messages":t(o).priority_id,items:t(p).priori,label:"Prioridade","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(f),"onUpdate:modelValue":s[14]||(s[14]=i=>_(f)?f.value=i:null),"error-messages":t(o).priority_justification,label:"Justificativa da Prioridade",variant:"outlined",color:"primary",rows:"5"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12",md:"12"},{default:a(()=>[e(B,{modelValue:t(J),"onUpdate:modelValue":s[15]||(s[15]=i=>_(J)?J.value=i:null),"error-messages":t(o).complexity_id,items:t(p).complexity,label:"Complexidade do Chamado","item-title":"name","item-value":"id"},null,8,["modelValue","error-messages","items"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(C),"onUpdate:modelValue":s[16]||(s[16]=i=>_(C)?C.value=i:null),"error-messages":t(o).complexity_justification,label:"Justificativa da Complexidade",variant:"outlined",color:"primary",rows:"5"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(Ee,{modelValue:t(de),"onUpdate:modelValue":s[17]||(s[17]=i=>_(de)?de.value=i:null),label:t(de)?"Ativo":"Inativo",color:"primary",inset:""},null,8,["modelValue","label"])]),_:1})]),_:1}),e(b,{justify:"end"},{default:a(()=>[e(d,{cols:"12",md:"auto"},{default:a(()=>[e(T,{flat:"",text:"Cancelar",onClick:s[18]||(s[18]=i=>v("cancel"))})]),_:1}),e(d,{cols:"12",md:"auto"},{default:a(()=>[e(T,{type:"submit",color:"primary",flat:"",loading:t(F),text:"Editar"},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]))}},Me=Te("chats",{state:()=>({messages:[]}),actions:{async fetchMessages(m){try{const v=await R.get(`/api/interactions/${m}`);this.messages=v.data}catch(v){console.error("Error fetching messages:",v)}},async createInteraction(m,v,l){try{return(await R.post("/api/interactions",{task_id:m,comment:v,user_id:l})).data}catch(p){console.error("Error creating interaction:",p)}},async uploadFile(m){try{return(await R.post("/api/interaction-file",m,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(v){throw console.error("Error uploading file:",v),v}}}}),ia=u("span",{class:"text-h5"},"Notas de Trabalho",-1),ra={key:0},na=["href"],da=j("Adicionar Comentário"),ua=j("Fechar"),ma=u("span",{class:"text-h5"},"Adicionar Comentário",-1),ca=j("Cancelar"),pa=j("Adicionar"),we={props:{taskId:{type:Number,required:!0},showChatModal:{type:Boolean,required:!0},userId:{type:Number,required:!0}},emits:["update:showChatModal"],setup(m,{emit:v}){const l=m,p=Me(),{messages:U}=ue(p),$=L(!1),q=L(!1),o=be({comment:E().required().label("Comentário"),files:Fe().of(Oe()).nullable()}),{handleSubmit:F,errors:k,isSubmitting:h}=ke({validationSchema:o,initialValues:{comment:"",files:[]}}),x=F(async I=>{try{const y=await p.createInteraction(l.taskId,I.comment,l.userId);if(I.files&&I.files.length>0){const P=new FormData;P.append("interaction_id",y.id);for(const n of I.files)P.append("files[]",n);await p.uploadFile(P)}await p.fetchMessages(l.taskId),q.value=!1,v("update:showChatModal",!1)}catch(y){console.error("Erro ao adicionar comentário ou fazer upload dos arquivos:",y)}}),{value:A}=r("comment"),{value:M}=r("files");se(()=>l.showChatModal,async I=>{I?($.value=!0,await p.fetchMessages(l.taskId)):$.value=!1});const w=()=>{v("update:showChatModal",!1)},J=()=>{q.value=!0};return(I,y)=>{const P=ze("v-list-item-content");return S(),G(ee,{modelValue:$.value,"onUpdate:modelValue":y[4]||(y[4]=n=>$.value=n),"max-width":"800px"},{default:a(()=>[e(Y,null,{default:a(()=>[e(oe,null,{default:a(()=>[ia]),_:1}),e(ae,null,{default:a(()=>[e(ge,null,{default:a(()=>[e(b,null,{default:a(()=>[(S(!0),H(me,null,_e(t(U),(n,g)=>(S(),G(d,{key:g,cols:"12"},{default:a(()=>[e(Y,{class:"mb-3"},{default:a(()=>[e(ae,null,{default:a(()=>[j(O(n.comment)+" ",1),n.interaction_files&&n.interaction_files.length?(S(),H("div",ra,[e(Je),e(Re,null,{default:a(()=>[(S(!0),H(me,null,_e(n.interaction_files,(c,D)=>(S(),G(Be,{key:D},{default:a(()=>[e(P,null,{default:a(()=>[e(Le,null,{default:a(()=>[u("a",{href:c.file_url,target:"_blank"},O(c.name),9,na)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])):ie("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(ve,null,{default:a(()=>[e(T,{color:"primary",onClick:J},{default:a(()=>[da]),_:1}),e(T,{color:"secondary",onClick:w},{default:a(()=>[ua]),_:1})]),_:1})]),_:1}),e(ee,{modelValue:q.value,"onUpdate:modelValue":y[3]||(y[3]=n=>q.value=n),"max-width":"500px"},{default:a(()=>[e(Y,null,{default:a(()=>[e(oe,null,{default:a(()=>[ma]),_:1}),e(ae,null,{default:a(()=>[e(ye,{onSubmit:t(x)},{default:a(()=>[e(W,{modelValue:t(A),"onUpdate:modelValue":y[0]||(y[0]=n=>_(A)?A.value=n:null),label:"Comentário","error-messages":t(k).comment},null,8,["modelValue","error-messages"]),e(Ge,{modelValue:t(M),"onUpdate:modelValue":y[1]||(y[1]=n=>_(M)?M.value=n:null),label:"Selecionar Arquivos","error-messages":t(k).files,"show-size":"",multiple:""},null,8,["modelValue","error-messages"])]),_:1},8,["onSubmit"])]),_:1}),e(ve,null,{default:a(()=>[e(T,{color:"blue darken-1",text:"",onClick:y[2]||(y[2]=n=>q.value=!1)},{default:a(()=>[ca]),_:1}),e(T,{color:"blue darken-1",text:"",loading:t(h),onClick:t(x)},{default:a(()=>[pa]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},fa={class:"mb-5 pb-5 border-b border-opacity-100"},_a=u("h1",{class:"text-h3"},"Meus chamados",-1),va=j("Novo Chamado"),ba=j("Adicionar chamado"),ga=j("Editar chamado"),ya=j("Cancelar"),ka=j("Deletar"),Va=u("span",{class:"text-h5"},"Adicionar Nota de Trabalho",-1),ha=j("Cancelar"),xa=j("Adicionar"),Ta={setup(m){const v=$e(),l=ce(),{toEdit:p,toDelete:U}=ue(l),$=Me();ue($);const{isLoading:q}=le(l.getTasks());le(l.getPriorities()),le(l.getComplexities()),le(l.getTasksStatus()),le(l.getUsers());const o=X({get(){return!!Object.keys(p.value).length},set(n){n||(p.value={})}}),F=X({get(){return!!Object.keys(U.value).length},set(n){n||(U.value={})}}),k=L(!1);async function h(n){k.value=!0,await l.deleteTask(n.id),U.value={},k.value=!1}const x=L(!1),A=L(null),M=L(!1),w=L(""),J=L(v.user.id),I=n=>{A.value=n.id,x.value=!0},y=n=>{A.value=n.id,M.value=!0},P=async()=>{await $.addMessage(A.value,w.value,J.value),w.value="",M.value=!1};return(n,g)=>(S(),H("div",null,[u("div",fa,[e(b,null,{default:a(()=>[e(d,null,{default:a(()=>[_a]),_:1}),e(d,{class:"text-right"},{default:a(()=>[e(ee,{width:"auto"},{activator:a(({props:c})=>[e(T,Z({flat:"",color:"primary"},c),{default:a(()=>[va]),_:2},1040)]),default:a(({isActive:c})=>[e(Y,{width:"400"},{default:a(()=>[e(oe,null,{default:a(()=>[ba]),_:1}),e(ae,null,{default:a(()=>[e(sa,{onAdd:D=>c.value=!1,onCancel:D=>c.value=!1},null,8,["onAdd","onCancel"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1})]),_:1})]),t(q)?(S(),G(Qe,{key:0,width:3,color:"primary",indeterminate:""})):(S(),H(me,{key:1},[e(la,{onOpenChat:I,onAddNote:y}),e(ee,{modelValue:t(o),"onUpdate:modelValue":g[0]||(g[0]=c=>_(o)?o.value=c:null),width:"auto"},{default:a(({isActive:c})=>[e(Y,{width:"400"},{default:a(()=>[e(oe,null,{default:a(()=>[ga]),_:1}),e(ae,null,{default:a(()=>[e(oa,{task:t(p),onCancel:D=>c.value=!1,onEdit:D=>c.value=!1},null,8,["task","onCancel","onEdit"])]),_:2},1024)]),_:2},1024)]),_:1},8,["modelValue"]),e(ee,{modelValue:t(F),"onUpdate:modelValue":g[2]||(g[2]=c=>_(F)?F.value=c:null),width:"auto"},{default:a(({isActive:c})=>[e(Y,{"prepend-icon":t(Se),title:"Você tem certeza que deseja deletar este chamado?"},{actions:a(()=>[e(He),e(T,{onClick:D=>c.value=!1},{default:a(()=>[ya]),_:2},1032,["onClick"]),e(T,{onClick:g[1]||(g[1]=D=>h(t(U))),variant:"tonal",color:"error",loading:k.value},{default:a(()=>[ka]),_:1},8,["loading"])]),_:2},1032,["prepend-icon"])]),_:1},8,["modelValue"])],64)),e(we,{taskId:A.value,showChatModal:x.value,userId:J.value,"onUpdate:showChatModal":g[3]||(g[3]=c=>x.value=c)},null,8,["taskId","showChatModal","userId"]),e(ee,{modelValue:M.value,"onUpdate:modelValue":g[6]||(g[6]=c=>M.value=c),"max-width":"500px"},{default:a(()=>[e(Y,null,{default:a(()=>[e(oe,null,{default:a(()=>[Va]),_:1}),e(ae,null,{default:a(()=>[e(we,{taskId:A.value,showChatModal:x.value,userId:J.value,"onUpdate:showChatModal":g[4]||(g[4]=c=>x.value=c)},null,8,["taskId","showChatModal","userId"])]),_:1}),e(ve,null,{default:a(()=>[e(T,{color:"blue darken-1",text:"",onClick:g[5]||(g[5]=c=>M.value=!1)},{default:a(()=>[ha]),_:1}),e(T,{color:"blue darken-1",text:"",onClick:P},{default:a(()=>[xa]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Ta as default};
